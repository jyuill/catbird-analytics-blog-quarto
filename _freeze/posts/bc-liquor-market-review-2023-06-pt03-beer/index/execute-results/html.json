{
  "hash": "539a40993eec16029264069dbdc3327e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"BC Liquor Sales Analysis: Beer 2015-2023\"\nauthor: John Yuill\ndate: '2023-11-26'\ncategories: [liquor stats, reporting, analysis]\ndescription-meta: BC Liquor Market Review data exploration and analysis covering the years 2016 to 2023, focusing on quarter-level trends, patterns and observations.\ndraft: true\n#image: .png \ntoc: true\ntoc-depth: 4\ntoc-location: left\ndate-modified: '2024-01-28'\nfig-height: 4\nfig-width: 6\ncode-fold: true\nexecute:\n  echo: true\n  error: false\n  warning: false\n---\n\n\n\n::: {.cell}\n\n:::\n\n\nThis is a continuation of a previous analysis of [annual liquor sales in British Columbia](../bc-liquor-market-review-2023-06-pt01-annual-trends) and [quarter-of-year patterns in BC liquor sales](../bc-liquor-market-review-2023-06-pt02-quarterly-trends), based on data from **British Columbia Liquor Distribution Board** '[**Liquor Market Review**](https://www.bcldb.com/publications/liquor-market-review)'. The Liquor Market Review is released on a quarterly basis, covering dollar and litre sales across major alcoholic beverage categories: here we focus on **BEER**!\n\nData goes back to 2015 (BC LDB Fiscal Year 2016, since fiscal yr ends in March).\n\n**As mentioned in previous articles:** *my expertise is in data analysis, not the liquor industry, so the emphasis is on exploring what the data can tell us. Industry-insider context may be lacking. In the interest of promoting data analysis and learning, I am sharing most of the R code used to process the data - hence the expandable 'Code' options.*\n\n## Beer Sales Trends\n\n### Overview\n\nWe'll start with an annual overview across all beer categories and then look at trends for individual categories further down below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# remove partial yrs - first identify complete yrs\nyr_qtr <- lmr_data %>% group_by(year, qtr) %>% summarize(count=1)\nyr_qtr <- yr_qtr %>% group_by(year) %>% summarize(count=n()) %>% filter(count==4)\n\n# summarize by calendar yr\ntrend_yr <- lmr_data %>% group_by(year) %>% summarize(\n  netsales=sum(netsales),\n  litres=sum(litres)\n) %>% filter(year %in% yr_qtr$year) ## include only complete yrs\n\n# add % chg YoY, $/l\ntrend_yr <- trend_yr %>% mutate(\n  pc_chg_sales=netsales/lag(netsales)-1,\n  pc_chg_litres=litres/lag(litres)-1,\n  dollar_per_litre=netsales/litres,\n  pc_chg_d_per_l=dollar_per_litre/lag(dollar_per_litre)-1\n)\n```\n:::\n\n\nBeer sales have been pretty stable over the last few years, with net \\$ sales peaking in 2017, recovering in 2022 in line with inflation. Overall **slight downward trend**, most noticeable in litre consumption.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# dual axis - not usually recommended but works ok here\nch_title <- \"BC Beer: Net Sales $ + Litre Sales trend\"\ntrend_yr %>% ggplot(aes(x=as.factor(year), y=netsales, group=1))+\n  geom_line(color=bar_col, size=2)+\n  geom_smooth(aes(y=netsales), method='lm', se=FALSE, color='brown', linetype='solid', size=1)+\n  geom_point(aes(y=netsales), color=bar_col, size=3)+\n  geom_line(aes(x=as.factor(year), y=litres*3), size=2, color='royalblue')+\n  geom_smooth(aes(y=litres*3), method='lm', se=FALSE, color='brown')+\n  geom_point(aes(x=as.factor(year), y=litres*3), size=3, color='royalblue')+\n  scale_y_continuous(name='netsales',\n                      labels=comma_format(prefix=\"$\", scale=1e-9,suffix=\"B\"), \n                     expand=expansion(mult=c(0,0.1)), \n                     limits=c(0,max(trend_yr$netsales)),\n                     sec.axis = sec_axis(trans=~./3, name='litres',\n                                         labels=comma_format(scale=1e-6, \n                                                             suffix=\"M\")))+\n  labs(title=ch_title, x=\"\")+\n  theme_classic()+\n  theme(\n    axis.title.y = element_text(color = bar_col, size=13),\n    axis.title.y.right = element_text(color = 'royalblue', size=13)\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/sales dual-axis-1.png){width=576}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntrend_yr_qtr <- lmr_data %>% group_by(end_qtr_dt) %>% summarize(\n  netsales=sum(netsales),\n  litres=sum(litres)\n) \n```\n:::\n\n\nBreaking out litre sales by quarter confirms the **downward trend**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nch_title <- \"BC Beer Litre Sales by Qtr, with Trend\"\ntrend_yr_qtr %>% ggplot(aes(x=end_qtr_dt, y=litres, group=1))+\n  geom_line(color=bar_col, size=2)+\n  #geom_point(aes(y=litres), color=bar_col, size=3)+\n  geom_smooth(method='lm', se=FALSE)+\n  scale_y_continuous(labels=comma_format(scale=1e-6,suffix=\"M\"), \n                     expand=expansion(mult=c(0,0.1)), \n                     limits=c(0,max(trend_yr_qtr$litres)))+\n  labs(title=ch_title, x=\"\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=576}\n:::\n:::\n\n\n### Sales by Category\n\nBC LDB puts beer into 3 major categories for purposes of the Liquor Market Report:\n\n-   **Domestic - BC Beer:** beer produced in BC.\n-   **Domestic - Other Province Beer:** beer produced in Canada outside BC.\n-   **Import Beer:** beer imported from outside Canada.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# summarize data by year and major category\ntrend_yr_cat <- lmr_data %>% group_by(year, category) %>% summarize(\n  netsales=sum(netsales),\n  litres=sum(litres)\n) %>% filter(year %in% yr_qtr$year) \n\n# calc % of yr sales by category\n# get totals for each yr\ntrend_yr_ttl <- trend_yr %>% select(year, netsales, litres) %>% \n  rename(\n    ttl_netsales=netsales,\n    ttl_litres=litres\n  )\n# join with trend_yr_cat to get yr total cols\ntrend_yr_cat <- left_join(trend_yr_cat, trend_yr_ttl, by='year')\n# calc %\ntrend_yr_cat <- trend_yr_cat %>% mutate(\n  litres_pc=litres/ttl_litres,\n  netsales_pc=litres/ttl_netsales\n)\n\n# add % chg YoY, $/l\n# ungroup first; use n=3 to lag 3 rows to match categories\ntrend_yr_cat <- trend_yr_cat %>% ungroup() %>% mutate(\n  pc_chg_sales=netsales/lag(netsales, n=3)-1,\n  pc_chg_litres=litres/lag(litres, n=3)-1,\n  dollar_per_litre=netsales/litres,\n  pc_chg_d_per_l=dollar_per_litre/lag(dollar_per_litre, n=3)-1\n)\n## simplify category names\n#unique(trend_yr_cat$category)\ntrend_yr_cat <- trend_yr_cat %>% mutate(\n  category=case_when(\n    category=='Domestic - BC Beer' ~ 'BC',\n    category=='Domestic - Other Province Beer' ~ 'Other Prov.',\n    category=='Import Beer' ~ 'Import'\n  )\n)\n```\n:::\n\n\n#### Litre sales\n\nLooking at litre consumption for these 3 main categories:\n\n-   volume drops in the BC and Import beer, with **other province beer actually increasing**.\n-   in % terms, litre market share for BC remained steady just over 75%, while **other provinces took their market share out of imports**.\n\n\n::: {.cell layout-ncol=\"2\"}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-dea0873a03d154b4ce64\" style=\"width:100%;height:325px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-dea0873a03d154b4ce64\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[276228271,279503235,272244392,260747188,248667911,232790016,231209796],\"x\":[1,2,3,4,5,6,7],\"y\":[19031947,18530901,22453182,23764263,26715838,37213634,36666210],\"text\":[\"as.factor(year): 2016<br />litres:  19031947<br />category: Other Prov.\",\"as.factor(year): 2017<br />litres:  18530901<br />category: Other Prov.\",\"as.factor(year): 2018<br />litres:  22453182<br />category: Other Prov.\",\"as.factor(year): 2019<br />litres:  23764263<br />category: Other Prov.\",\"as.factor(year): 2020<br />litres:  26715838<br />category: Other Prov.\",\"as.factor(year): 2021<br />litres:  37213634<br />category: Other Prov.\",\"as.factor(year): 2022<br />litres:  36666210<br />category: Other Prov.\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Other Prov.\",\"legendgroup\":\"Other Prov.\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[229971335,232837354,230809520,221197743,214899460,210304493,209073308],\"x\":[1,2,3,4,5,6,7],\"y\":[46256936,46665881,41434872,39549445,33768451,22485523,22136488],\"text\":[\"as.factor(year): 2016<br />litres:  46256936<br />category: Import\",\"as.factor(year): 2017<br />litres:  46665881<br />category: Import\",\"as.factor(year): 2018<br />litres:  41434872<br />category: Import\",\"as.factor(year): 2019<br />litres:  39549445<br />category: Import\",\"as.factor(year): 2020<br />litres:  33768451<br />category: Import\",\"as.factor(year): 2021<br />litres:  22485523<br />category: Import\",\"as.factor(year): 2022<br />litres:  22136488<br />category: Import\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,186,56,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Import\",\"legendgroup\":\"Import\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0,0,0,0,0,0,0],\"x\":[1,2,3,4,5,6,7],\"y\":[229971335,232837354,230809520,221197743,214899460,210304493,209073308],\"text\":[\"as.factor(year): 2016<br />litres: 229971335<br />category: BC\",\"as.factor(year): 2017<br />litres: 232837354<br />category: BC\",\"as.factor(year): 2018<br />litres: 230809520<br />category: BC\",\"as.factor(year): 2019<br />litres: 221197743<br />category: BC\",\"as.factor(year): 2020<br />litres: 214899460<br />category: BC\",\"as.factor(year): 2021<br />litres: 210304493<br />category: BC\",\"as.factor(year): 2022<br />litres: 209073308<br />category: BC\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(97,156,255,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"BC\",\"legendgroup\":\"BC\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":48.146118721461193,\"r\":7.3059360730593621,\"b\":31.995975037917269,\"l\":34.337899543379002},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Beer Litre Sales by Cat.\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,7.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\"],\"tickvals\":[1,2,3,4.0000000000000009,5,6,7],\"categoryorder\":\"array\",\"categoryarray\":[\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-45,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0,298034136.10000002],\"tickmode\":\"array\",\"ticktext\":[\"0M\",\"100M\",\"200M\"],\"tickvals\":[0,100000000,200000000],\"categoryorder\":\"array\",\"categoryarray\":[\"0M\",\"100M\",\"200M\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"category\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"cd671a7e27cd\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"bar\"}},\"cur_data\":\"cd671a7e27cd\",\"visdat\":{\"cd671a7e27cd\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-101aefabffe58911cb99\" style=\"width:100%;height:325px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-101aefabffe58911cb99\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0.93554178368858343,0.93782289086509207,0.92380941011750584,0.91647343923601865,0.90298687523496535,0.86217358913481357,0.8631224552452077],\"x\":[1,2,3,4,5,6,7],\"y\":[0.064458216311416572,0.062177109134907926,0.076190589882494164,0.08352656076398135,0.097013124765034653,0.13782641086518643,0.1368775447547923],\"text\":[\"as.factor(year): 2016<br />litres_pc: 0.06445822<br />category: Other Prov.\",\"as.factor(year): 2017<br />litres_pc: 0.06217711<br />category: Other Prov.\",\"as.factor(year): 2018<br />litres_pc: 0.07619059<br />category: Other Prov.\",\"as.factor(year): 2019<br />litres_pc: 0.08352656<br />category: Other Prov.\",\"as.factor(year): 2020<br />litres_pc: 0.09701312<br />category: Other Prov.\",\"as.factor(year): 2021<br />litres_pc: 0.13782641<br />category: Other Prov.\",\"as.factor(year): 2022<br />litres_pc: 0.13687754<br />category: Other Prov.\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Other Prov.\",\"legendgroup\":\"Other Prov.\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0.77887680418904248,0.78124391093240408,0.78320807622257527,0.77746516782552977,0.78036362269147563,0.7788950001231465,0.78048538621260466],\"x\":[1,2,3,4,5,6,7],\"y\":[0.15666497949954095,0.15657897993268799,0.14060133389493057,0.13900827141048888,0.12262325254348971,0.08327858901166707,0.082637069032603039],\"text\":[\"as.factor(year): 2016<br />litres_pc: 0.15666498<br />category: Import\",\"as.factor(year): 2017<br />litres_pc: 0.15657898<br />category: Import\",\"as.factor(year): 2018<br />litres_pc: 0.14060133<br />category: Import\",\"as.factor(year): 2019<br />litres_pc: 0.13900827<br />category: Import\",\"as.factor(year): 2020<br />litres_pc: 0.12262325<br />category: Import\",\"as.factor(year): 2021<br />litres_pc: 0.08327859<br />category: Import\",\"as.factor(year): 2022<br />litres_pc: 0.08263707<br />category: Import\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,186,56,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Import\",\"legendgroup\":\"Import\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0,0,0,0,0,0,0],\"x\":[1,2,3,4,5,6,7],\"y\":[0.77887680418904248,0.78124391093240408,0.78320807622257527,0.77746516782552977,0.78036362269147563,0.7788950001231465,0.78048538621260466],\"text\":[\"as.factor(year): 2016<br />litres_pc: 0.77887680<br />category: BC\",\"as.factor(year): 2017<br />litres_pc: 0.78124391<br />category: BC\",\"as.factor(year): 2018<br />litres_pc: 0.78320808<br />category: BC\",\"as.factor(year): 2019<br />litres_pc: 0.77746517<br />category: BC\",\"as.factor(year): 2020<br />litres_pc: 0.78036362<br />category: BC\",\"as.factor(year): 2021<br />litres_pc: 0.77889500<br />category: BC\",\"as.factor(year): 2022<br />litres_pc: 0.78048539<br />category: BC\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(97,156,255,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"BC\",\"legendgroup\":\"BC\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":48.146118721461193,\"r\":7.3059360730593621,\"b\":31.995975037917269,\"l\":34.337899543379002},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Beer % Litre Sales by Cat.\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,7.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\"],\"tickvals\":[1,2,3,4.0000000000000009,5,6,7],\"categoryorder\":\"array\",\"categoryarray\":[\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-45,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0,1],\"tickmode\":\"array\",\"ticktext\":[\"0%\",\"25%\",\"50%\",\"75%\",\"100%\"],\"tickvals\":[0,0.25,0.5,0.75,1],\"categoryorder\":\"array\",\"categoryarray\":[\"0%\",\"25%\",\"50%\",\"75%\",\"100%\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"category\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"cd671f3d1ac2\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"bar\"}},\"cur_data\":\"cd671f3d1ac2\",\"visdat\":{\"cd671f3d1ac2\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Sales by Subcategory within Categories\n\nEach of the main categories above has sub-categories as well. Let's look at how things break-out there.\n\n#### BC Beer\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrend_yr_subcat <- lmr_data %>% \n  filter(category=='Domestic - BC Beer') %>%\n  group_by(year, subcategory) %>% summarize(\n    netsales=sum(netsales),\n    litres=sum(litres)\n) %>% filter(year %in% yr_qtr$year)\n\n# calc % of yr sales by category\n# get totals for each yr\ntrend_yr_ttl_sub <- trend_yr_subcat %>% select(year, netsales, litres) %>% \n  group_by(year) %>% \n  summarize(\n    ttl_netsales=sum(netsales),\n    ttl_litres=sum(litres)\n  ) \n# join with trend_yr_cat to get yr total cols\ntrend_yr_subcat <- left_join(trend_yr_subcat, trend_yr_ttl_sub, by='year')\n# calc %\ntrend_yr_subcat <- trend_yr_subcat %>% mutate(\n  litres_pc=litres/ttl_litres,\n  netsales_pc=litres/ttl_netsales\n)\n\n# simplify subcategory names\ntrend_yr_subcat <- trend_yr_subcat %>% mutate(\n  subcat=str_replace(subcategory, \"Domestic - BC \",\"\"),\n  subcat=str_replace(subcat, \" Beer\",\"\")\n)\n```\n:::\n\n::: {.cell layout-ncol=\"2\"}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-83bbaf8b0f6e7de6c097\" style=\"width:100%;height:325px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-83bbaf8b0f6e7de6c097\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[208855128,206586789,200511769,192049468,188486547,180638056,178339364],\"x\":[1,2,3,4,5,6,7],\"y\":[21116207,26250565,30297751,29148275,26412913,29666437,30733944],\"text\":[\"as.factor(year): 2016<br />litres:  21116207<br />subcat: Micro Brew\",\"as.factor(year): 2017<br />litres:  26250565<br />subcat: Micro Brew\",\"as.factor(year): 2018<br />litres:  30297751<br />subcat: Micro Brew\",\"as.factor(year): 2019<br />litres:  29148275<br />subcat: Micro Brew\",\"as.factor(year): 2020<br />litres:  26412913<br />subcat: Micro Brew\",\"as.factor(year): 2021<br />litres:  29666437<br />subcat: Micro Brew\",\"as.factor(year): 2022<br />litres:  30733944<br />subcat: Micro Brew\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Micro Brew\",\"legendgroup\":\"Micro Brew\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[171596671,165625505,157315717,143100420,138532590,131728136,127894482],\"x\":[1,2,3,4,5,6,7],\"y\":[37258457,40961284,43196052,48949048,49953957,48909920,50444882],\"text\":[\"as.factor(year): 2016<br />litres:  37258457<br />subcat: Regional\",\"as.factor(year): 2017<br />litres:  40961284<br />subcat: Regional\",\"as.factor(year): 2018<br />litres:  43196052<br />subcat: Regional\",\"as.factor(year): 2019<br />litres:  48949048<br />subcat: Regional\",\"as.factor(year): 2020<br />litres:  49953957<br />subcat: Regional\",\"as.factor(year): 2021<br />litres:  48909920<br />subcat: Regional\",\"as.factor(year): 2022<br />litres:  50444882<br />subcat: Regional\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,186,56,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Regional\",\"legendgroup\":\"Regional\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0,0,0,0,0,0,0],\"x\":[1,2,3,4,5,6,7],\"y\":[171596671,165625505,157315717,143100420,138532590,131728136,127894482],\"text\":[\"as.factor(year): 2016<br />litres: 171596671<br />subcat: Commercial\",\"as.factor(year): 2017<br />litres: 165625505<br />subcat: Commercial\",\"as.factor(year): 2018<br />litres: 157315717<br />subcat: Commercial\",\"as.factor(year): 2019<br />litres: 143100420<br />subcat: Commercial\",\"as.factor(year): 2020<br />litres: 138532590<br />subcat: Commercial\",\"as.factor(year): 2021<br />litres: 131728136<br />subcat: Commercial\",\"as.factor(year): 2022<br />litres: 127894482<br />subcat: Commercial\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(97,156,255,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Commercial\",\"legendgroup\":\"Commercial\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":48.146118721461193,\"r\":7.3059360730593621,\"b\":31.995975037917269,\"l\":34.337899543379002},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"BC Beer Litre Sales by Subcat.\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,7.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\"],\"tickvals\":[1,2,3,4.0000000000000009,5,6,7],\"categoryorder\":\"array\",\"categoryarray\":[\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-45,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0,232837354.09999999],\"tickmode\":\"array\",\"ticktext\":[\"0M\",\"50M\",\"100M\",\"150M\",\"200M\"],\"tickvals\":[0,50000000,100000000,150000000,200000000],\"categoryorder\":\"array\",\"categoryarray\":[\"0M\",\"50M\",\"100M\",\"150M\",\"200M\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"subcat\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"cd6742eedce8\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"bar\"}},\"cur_data\":\"cd6742eedce8\",\"visdat\":{\"cd6742eedce8\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-c853d85b89dc63639055\" style=\"width:100%;height:325px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-c853d85b89dc63639055\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0.90817896065176995,0.88725793113075835,0.868732663193442,0.86822526032736236,0.87709176654050225,0.85893579078217797,0.85299919777420841],\"x\":[1,2,3,4,5,6,7],\"y\":[0.091821039348230049,0.11274206886924165,0.131267336806558,0.13177473967263764,0.12290823345949775,0.14106420921782203,0.14700080222579159],\"text\":[\"as.factor(year): 2016<br />litres_pc: 0.09182104<br />subcat: Micro Brew\",\"as.factor(year): 2017<br />litres_pc: 0.11274207<br />subcat: Micro Brew\",\"as.factor(year): 2018<br />litres_pc: 0.13126734<br />subcat: Micro Brew\",\"as.factor(year): 2019<br />litres_pc: 0.13177474<br />subcat: Micro Brew\",\"as.factor(year): 2020<br />litres_pc: 0.12290823<br />subcat: Micro Brew\",\"as.factor(year): 2021<br />litres_pc: 0.14106421<br />subcat: Micro Brew\",\"as.factor(year): 2022<br />litres_pc: 0.14700080<br />subcat: Micro Brew\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Micro Brew\",\"legendgroup\":\"Micro Brew\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0.7461654775365808,0.71133562615558676,0.68158244512618027,0.64693435863855087,0.64463907913030583,0.62636862446871266,0.61172075586042762],\"x\":[1,2,3,4,5,6,7],\"y\":[0.16201348311518915,0.17592230497517158,0.18715021806726173,0.22129090168881149,0.23245268741019642,0.2325671663134653,0.24127844191378078],\"text\":[\"as.factor(year): 2016<br />litres_pc: 0.16201348<br />subcat: Regional\",\"as.factor(year): 2017<br />litres_pc: 0.17592230<br />subcat: Regional\",\"as.factor(year): 2018<br />litres_pc: 0.18715022<br />subcat: Regional\",\"as.factor(year): 2019<br />litres_pc: 0.22129090<br />subcat: Regional\",\"as.factor(year): 2020<br />litres_pc: 0.23245269<br />subcat: Regional\",\"as.factor(year): 2021<br />litres_pc: 0.23256717<br />subcat: Regional\",\"as.factor(year): 2022<br />litres_pc: 0.24127844<br />subcat: Regional\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,186,56,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Regional\",\"legendgroup\":\"Regional\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0,0,0,0,0,0,0],\"x\":[1,2,3,4,5,6,7],\"y\":[0.7461654775365808,0.71133562615558676,0.68158244512618027,0.64693435863855087,0.64463907913030583,0.62636862446871266,0.61172075586042762],\"text\":[\"as.factor(year): 2016<br />litres_pc: 0.74616548<br />subcat: Commercial\",\"as.factor(year): 2017<br />litres_pc: 0.71133563<br />subcat: Commercial\",\"as.factor(year): 2018<br />litres_pc: 0.68158245<br />subcat: Commercial\",\"as.factor(year): 2019<br />litres_pc: 0.64693436<br />subcat: Commercial\",\"as.factor(year): 2020<br />litres_pc: 0.64463908<br />subcat: Commercial\",\"as.factor(year): 2021<br />litres_pc: 0.62636862<br />subcat: Commercial\",\"as.factor(year): 2022<br />litres_pc: 0.61172076<br />subcat: Commercial\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(97,156,255,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Commercial\",\"legendgroup\":\"Commercial\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":48.146118721461193,\"r\":7.3059360730593621,\"b\":31.995975037917269,\"l\":34.337899543379002},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"BC Beer % Litres by Subcat.\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,7.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\"],\"tickvals\":[1,2,3,4.0000000000000009,5,6,7],\"categoryorder\":\"array\",\"categoryarray\":[\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-45,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0,1],\"tickmode\":\"array\",\"ticktext\":[\"0%\",\"25%\",\"50%\",\"75%\",\"100%\"],\"tickvals\":[0,0.25,0.5,0.75,1],\"categoryorder\":\"array\",\"categoryarray\":[\"0%\",\"25%\",\"50%\",\"75%\",\"100%\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"subcat\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"cd6755505238\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"bar\"}},\"cur_data\":\"cd6755505238\",\"visdat\":{\"cd6755505238\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n## questions\n\n-   breakdown by major category\n    -   by year -\\> \\$ sales and litre sales\n        -   changes in composition?\n    -   yoy change\n-   within each major category\n    -   annual trends -\\> \\$ sales and litre sales\n        -   changes in composition?\n    -   yoy change -\\> what are the biggest gainers / losers?\n\n## == old info\n\n### Quarter Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# roll-up categories by qtr\ntrend_ttl_qtr <- lmr_data %>% group_by(year, fyr, fy_qtr, qtr) %>% summarize(\n  netsales=sum(netsales),\n  litres=sum(litres)\n)\n# calculate quarterly info\ntrend_qtr <- lmr_data %>% group_by(fy_qtr, start_qtr_dt, qtr) %>% \n  summarize(netsales=sum(netsales),\n            litres=sum(litres)\n            )\n\ntrend_qtr <- trend_qtr %>% ungroup() %>% mutate(\n            pc_chg_sales=netsales/lag(netsales)-1,\n            pc_chg_litres=litres/lag(litres)-1,\n            pc_chg_sales_qtr=netsales/lag(netsales, n=4),\n            pc_chg_litres_qtr=litres/lag(litres, n=4)\n)\n# averages\ntrend_qtrs <- trend_qtr %>% group_by(qtr) %>% summarize(\n  avgsales=mean(netsales),\n  avglitres=mean(litres),\n  avg_sales_pc_chg=mean(pc_chg_sales, na.rm=TRUE),\n  avg_litres_pc_chg=mean(pc_chg_litres, na.rm=TRUE)\n)\n```\n:::\n\n\n#### \\$ Qtr Sales\n\nOverlay of \\$ sales data for quarter of each year to see overall trends:\n\n-   sales are mostly even in Q2 (Jul-Aug-Sep) and Q3 (Oct-Nov-Dec), covering most of the summer and the Christmas holiday season.\n-   Q4 (Jan-Feb-Mar) by far the slowest period.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nch_title <- \"$ Sales Comparison by Quarter (fiscal yr end Mar 31)\"\nplot <- trend_ttl_qtr %>% ggplot(aes(x=qtr, y=netsales, color=factor(fyr), group=fyr))+\n  geom_line()+\n  geom_point()+\n  geom_line(data=trend_qtrs, aes(x=qtr, y=avgsales, group=1), color='black', size=1.5)+\n  scale_y_continuous(labels=label_comma(scale=1e-6, prefix=\"$\", suffix=\"M\"), expand=expansion(add=c(0,0.1)), limits=c(0,max(trend_ttl_qtr$netsales)))+\n  labs(title=ch_title, x=\"\", y=\"Net $ Sales\", color='fiscal yr')\nggplotly(plot)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-c8248f6f068246094000\" style=\"width:100%;height:433px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-c8248f6f068246094000\">{\"x\":{\"data\":[{\"x\":[1,2,3,4],\"y\":[296415914,296313370,263890676,223610104],\"text\":[\"qtr: Q1<br />netsales: 296415914<br />factor(fyr): 2016<br />fyr: 2016\",\"qtr: Q2<br />netsales: 296313370<br />factor(fyr): 2016<br />fyr: 2016\",\"qtr: Q3<br />netsales: 263890676<br />factor(fyr): 2016<br />fyr: 2016\",\"qtr: Q4<br />netsales: 223610104<br />factor(fyr): 2016<br />fyr: 2016\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(248,118,109,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2016\",\"legendgroup\":\"2016\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(248,118,109,1)\"}},\"frame\":null},{\"x\":[1,2,3,4],\"y\":[303384860,301963407,251864054,223766066],\"text\":[\"qtr: Q1<br />netsales: 303384860<br />factor(fyr): 2017<br />fyr: 2017\",\"qtr: Q2<br />netsales: 301963407<br />factor(fyr): 2017<br />fyr: 2017\",\"qtr: Q3<br />netsales: 251864054<br />factor(fyr): 2017<br />fyr: 2017\",\"qtr: Q4<br />netsales: 223766066<br />factor(fyr): 2017<br />fyr: 2017\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(211,146,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2017\",\"legendgroup\":\"2017\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(211,146,0,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(211,146,0,1)\"}},\"frame\":null},{\"x\":[1,2,3,4],\"y\":[310862361,310398035,268128908,234150242],\"text\":[\"qtr: Q1<br />netsales: 310862361<br />factor(fyr): 2018<br />fyr: 2018\",\"qtr: Q2<br />netsales: 310398035<br />factor(fyr): 2018<br />fyr: 2018\",\"qtr: Q3<br />netsales: 268128908<br />factor(fyr): 2018<br />fyr: 2018\",\"qtr: Q4<br />netsales: 234150242<br />factor(fyr): 2018<br />fyr: 2018\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(147,170,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2018\",\"legendgroup\":\"2018\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(147,170,0,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(147,170,0,1)\"}},\"frame\":null},{\"x\":[1,2,3,4],\"y\":[310210257,311972676,258932921,229246186],\"text\":[\"qtr: Q1<br />netsales: 310210257<br />factor(fyr): 2019<br />fyr: 2019\",\"qtr: Q2<br />netsales: 311972676<br />factor(fyr): 2019<br />fyr: 2019\",\"qtr: Q3<br />netsales: 258932921<br />factor(fyr): 2019<br />fyr: 2019\",\"qtr: Q4<br />netsales: 229246186<br />factor(fyr): 2019<br />fyr: 2019\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,186,56,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2019\",\"legendgroup\":\"2019\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,186,56,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,186,56,1)\"}},\"frame\":null},{\"x\":[1,2,3,4],\"y\":[305715244,297540524,251542172,231018434],\"text\":[\"qtr: Q1<br />netsales: 305715244<br />factor(fyr): 2020<br />fyr: 2020\",\"qtr: Q2<br />netsales: 297540524<br />factor(fyr): 2020<br />fyr: 2020\",\"qtr: Q3<br />netsales: 251542172<br />factor(fyr): 2020<br />fyr: 2020\",\"qtr: Q4<br />netsales: 231018434<br />factor(fyr): 2020<br />fyr: 2020\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,193,159,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2020\",\"legendgroup\":\"2020\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,193,159,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,193,159,1)\"}},\"frame\":null},{\"x\":[1,2,3,4],\"y\":[291015031,305099941,234435308,218988820],\"text\":[\"qtr: Q1<br />netsales: 291015031<br />factor(fyr): 2021<br />fyr: 2021\",\"qtr: Q2<br />netsales: 305099941<br />factor(fyr): 2021<br />fyr: 2021\",\"qtr: Q3<br />netsales: 234435308<br />factor(fyr): 2021<br />fyr: 2021\",\"qtr: Q4<br />netsales: 218988820<br />factor(fyr): 2021<br />fyr: 2021\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,185,227,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2021\",\"legendgroup\":\"2021\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,185,227,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,185,227,1)\"}},\"frame\":null},{\"x\":[1,2,3,4],\"y\":[298679045,291927506,244382459,225184442],\"text\":[\"qtr: Q1<br />netsales: 298679045<br />factor(fyr): 2022<br />fyr: 2022\",\"qtr: Q2<br />netsales: 291927506<br />factor(fyr): 2022<br />fyr: 2022\",\"qtr: Q3<br />netsales: 244382459<br />factor(fyr): 2022<br />fyr: 2022\",\"qtr: Q4<br />netsales: 225184442<br />factor(fyr): 2022<br />fyr: 2022\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(97,156,255,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2022\",\"legendgroup\":\"2022\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(97,156,255,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(97,156,255,1)\"}},\"frame\":null},{\"x\":[1,2,3,4],\"y\":[296089857,312426713,245413939,232027381],\"text\":[\"qtr: Q1<br />netsales: 296089857<br />factor(fyr): 2023<br />fyr: 2023\",\"qtr: Q2<br />netsales: 312426713<br />factor(fyr): 2023<br />fyr: 2023\",\"qtr: Q3<br />netsales: 245413939<br />factor(fyr): 2023<br />fyr: 2023\",\"qtr: Q4<br />netsales: 232027381<br />factor(fyr): 2023<br />fyr: 2023\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(219,114,251,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2023\",\"legendgroup\":\"2023\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(219,114,251,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(219,114,251,1)\"}},\"frame\":null},{\"x\":[1],\"y\":[296826447],\"text\":\"qtr: Q1<br />netsales: 296826447<br />factor(fyr): 2024<br />fyr: 2024\",\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(255,97,195,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2024\",\"legendgroup\":\"2024\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(255,97,195,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(255,97,195,1)\"}},\"frame\":null},{\"x\":[1,2,3,4],\"y\":[301022112.8888889,303455271.5,252323804.625,227248959.375],\"text\":[\"qtr: Q1<br />avgsales: 301022113<br />factor(fyr): black\",\"qtr: Q2<br />avgsales: 303455272<br />factor(fyr): black\",\"qtr: Q3<br />avgsales: 252323805<br />factor(fyr): black\",\"qtr: Q4<br />avgsales: 227248959<br />factor(fyr): black\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":5.6692913385826778,\"color\":\"rgba(0,0,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":44.493150684931507,\"r\":7.3059360730593621,\"b\":26.301369863013704,\"l\":54.794520547945211},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"$ Sales Comparison by Quarter (fiscal yr end Mar 31)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,4.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"Q1\",\"Q2\",\"Q3\",\"Q4\"],\"tickvals\":[1,2,3,4],\"categoryorder\":\"array\",\"categoryarray\":[\"Q1\",\"Q2\",\"Q3\",\"Q4\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0,312426713.10000002],\"tickmode\":\"array\",\"ticktext\":[\"$0M\",\"$100M\",\"$200M\",\"$300M\"],\"tickvals\":[0,100000000,200000000,300000000],\"categoryorder\":\"array\",\"categoryarray\":[\"$0M\",\"$100M\",\"$200M\",\"$300M\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Net $ Sales\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"fiscal yr\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"cd67787be772\":{\"x\":{},\"y\":{},\"colour\":{},\"type\":\"scatter\"},\"cd67e982b2a\":{\"x\":{},\"y\":{},\"colour\":{}},\"cd672839d9e2\":{\"x\":{},\"y\":{},\"colour\":{}}},\"cur_data\":\"cd67787be772\",\"visdat\":{\"cd67787be772\":[\"function (y) \",\"x\"],\"cd67e982b2a\":[\"function (y) \",\"x\"],\"cd672839d9e2\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n\nBC LDB fiscal yr end Mar 31, so Q1=Apr-May-Jun, and so on; black line = average.\n:::\n:::\n\n\nThe drop from Q3 to Q4 is the only consistent pattern across the years looked at. Relative level of sales between Q1-Q2 and Q2-Q3 varies from year to year.\n\nLooking at patterns in % change between quarters confirms that either ends of the fiscal yr have the biggest changes:\n\n-   Q4 has a consistently large drop from previous quarter and Q1 has consistently big increase from previous quarter.\n-   Q2 tends to show positive growth over Q1, but not always. Q3 straddles 0% change from previous.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nch_title <- \"Distribution of % Change in $ Sales Between Quarters\"\nplot <- trend_qtr %>% ggplot(aes(y=pc_chg_sales, x=qtr))+\n  geom_boxplot(fill=bar_col)+\n  scale_y_continuous(labels=percent_format())+\n  geom_hline(yintercept = 0, linetype='dotted')+\n  labs(title=ch_title, x=\"\",y=\"% chg from prev quarter\")\nggplotly(plot)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-1306c169296f037aebe6\" style=\"width:100%;height:433px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-1306c169296f037aebe6\">{\"x\":{\"data\":[{\"x\":[1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4],\"y\":[null,0.35675827958114104,0.38922923639368978,0.32483423613117601,0.33356741647165289,0.25970480347035863,0.36390088315924074,0.3148770597570858,0.27927335869036929,-0.00034594633809037489,-0.0046853129058582743,-0.0014936706988466497,0.0056813692011479233,-0.026739654500185783,0.048399252614549582,-0.022604662473057036,0.055175331453518828,-0.10942028704273454,-0.16591200072133239,-0.13617717328655121,-0.17001410405570261,-0.15459525103209137,-0.23161142794190182,-0.16286593768248747,-0.21449117892809633,-0.15264113386105393,-0.11156013553248056,-0.12672511238512185,-0.11465029199589494,-0.081591638637834474,-0.065888061537215159,-0.078557262573415665,-0.054546852776769184],\"hoverinfo\":\"y\",\"type\":\"box\",\"fillcolor\":\"rgba(8,29,88,1)\",\"marker\":{\"opacity\":null,\"outliercolor\":\"rgba(0,0,0,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,1)\"},\"size\":5.6692913385826778},\"line\":{\"color\":\"rgba(51,51,51,1)\",\"width\":1.8897637795275593},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[0.40000000000000002,4.5999999999999996],\"y\":[0,0],\"text\":\"yintercept: 0\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,1)\",\"dash\":\"dot\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":44.493150684931507,\"r\":7.3059360730593621,\"b\":26.301369863013704,\"l\":48.949771689497723},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Distribution of % Change in $ Sales Between Quarters\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,4.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"Q1\",\"Q2\",\"Q3\",\"Q4\"],\"tickvals\":[1,2,3,4],\"categoryorder\":\"array\",\"categoryarray\":[\"Q1\",\"Q2\",\"Q3\",\"Q4\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-0.26265346115868138,0.42027126961046934],\"tickmode\":\"array\",\"ticktext\":[\"-20%\",\"0%\",\"20%\",\"40%\"],\"tickvals\":[-0.20000000000000001,0,0.20000000000000001,0.40000000000000002],\"categoryorder\":\"array\",\"categoryarray\":[\"-20%\",\"0%\",\"20%\",\"40%\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"% chg from prev quarter\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"cd6719d18e55\":{\"x\":{},\"y\":{},\"type\":\"box\"},\"cd67cd77bb1\":{\"yintercept\":{}}},\"cur_data\":\"cd6719d18e55\",\"visdat\":{\"cd6719d18e55\":[\"function (y) \",\"x\"],\"cd67cd77bb1\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nThe middle black line represents median for each quarter, with the colored area representing the range from 25% of the time to 75% of the time (1st & 3rd quartiles).\n\n#### Litres\n\nOverlaying litres sold by quarter for each year shows volume changes throughout the year:\n\n-   Q2 (Jul-Aug-Sep) has highest sales, edging out Q1 (Apr-May-Jun)\n-   Q3 (Oct-Nov-Dec) sees drop, even with holidays, and then lower again for Q4 (Jan-Feb-Mar)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nch_title <- \"Litres Comparison by Quarter (fiscal yr end Mar 31)\"\nplot <- trend_ttl_qtr %>% ggplot(aes(x=qtr, y=litres, color=factor(fyr), group=fyr))+\n  geom_line()+\n  geom_point()+\n  geom_line(data=trend_qtrs, aes(x=qtr, y=avglitres, group=1), color='black', size=1.5)+\n  scale_y_continuous(labels=label_comma(scale=1e-6, suffix=\"M\"), expand=expansion(add=c(0,0.1)), limits=c(0,max(trend_ttl_qtr$litres)))+\n  labs(title=ch_title, x=\"\", y=\"litres\", color='fiscal yr')\nggplotly(plot)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-f00ced4438b773cd3155\" style=\"width:100%;height:433px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-f00ced4438b773cd3155\">{\"x\":{\"data\":[{\"x\":[1,2,3,4],\"y\":[82606644,82243251,72640388,61322665],\"text\":[\"qtr: Q1<br />litres: 82606644<br />factor(fyr): 2016<br />fyr: 2016\",\"qtr: Q2<br />litres: 82243251<br />factor(fyr): 2016<br />fyr: 2016\",\"qtr: Q3<br />litres: 72640388<br />factor(fyr): 2016<br />fyr: 2016\",\"qtr: Q4<br />litres: 61322665<br />factor(fyr): 2016<br />fyr: 2016\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(248,118,109,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2016\",\"legendgroup\":\"2016\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(248,118,109,1)\"}},\"frame\":null},{\"x\":[1,2,3,4],\"y\":[83049030,82507823,68380700,60411330],\"text\":[\"qtr: Q1<br />litres: 83049030<br />factor(fyr): 2017<br />fyr: 2017\",\"qtr: Q2<br />litres: 82507823<br />factor(fyr): 2017<br />fyr: 2017\",\"qtr: Q3<br />litres: 68380700<br />factor(fyr): 2017<br />fyr: 2017\",\"qtr: Q4<br />litres: 60411330<br />factor(fyr): 2017<br />fyr: 2017\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(211,146,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2017\",\"legendgroup\":\"2017\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(211,146,0,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(211,146,0,1)\"}},\"frame\":null},{\"x\":[1,2,3,4],\"y\":[83025876,83041441,71555489,62061657],\"text\":[\"qtr: Q1<br />litres: 83025876<br />factor(fyr): 2018<br />fyr: 2018\",\"qtr: Q2<br />litres: 83041441<br />factor(fyr): 2018<br />fyr: 2018\",\"qtr: Q3<br />litres: 71555489<br />factor(fyr): 2018<br />fyr: 2018\",\"qtr: Q4<br />litres: 62061657<br />factor(fyr): 2018<br />fyr: 2018\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(147,170,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2018\",\"legendgroup\":\"2018\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(147,170,0,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(147,170,0,1)\"}},\"frame\":null},{\"x\":[1,2,3,4],\"y\":[82184724,82590238,67860955,60160295],\"text\":[\"qtr: Q1<br />litres: 82184724<br />factor(fyr): 2019<br />fyr: 2019\",\"qtr: Q2<br />litres: 82590238<br />factor(fyr): 2019<br />fyr: 2019\",\"qtr: Q3<br />litres: 67860955<br />factor(fyr): 2019<br />fyr: 2019\",\"qtr: Q4<br />litres: 60160295<br />factor(fyr): 2019<br />fyr: 2019\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,186,56,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2019\",\"legendgroup\":\"2019\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,186,56,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,186,56,1)\"}},\"frame\":null},{\"x\":[1,2,3,4],\"y\":[80403293,78094657,65853206,60526961],\"text\":[\"qtr: Q1<br />litres: 80403293<br />factor(fyr): 2020<br />fyr: 2020\",\"qtr: Q2<br />litres: 78094657<br />factor(fyr): 2020<br />fyr: 2020\",\"qtr: Q3<br />litres: 65853206<br />factor(fyr): 2020<br />fyr: 2020\",\"qtr: Q4<br />litres: 60526961<br />factor(fyr): 2020<br />fyr: 2020\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,193,159,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2020\",\"legendgroup\":\"2020\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,193,159,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,193,159,1)\"}},\"frame\":null},{\"x\":[1,2,3,4],\"y\":[75782253,78733642,60340893,56628557],\"text\":[\"qtr: Q1<br />litres: 75782253<br />factor(fyr): 2021<br />fyr: 2021\",\"qtr: Q2<br />litres: 78733642<br />factor(fyr): 2021<br />fyr: 2021\",\"qtr: Q3<br />litres: 60340893<br />factor(fyr): 2021<br />fyr: 2021\",\"qtr: Q4<br />litres: 56628557<br />factor(fyr): 2021<br />fyr: 2021\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,185,227,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2021\",\"legendgroup\":\"2021\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,185,227,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,185,227,1)\"}},\"frame\":null},{\"x\":[1,2,3,4],\"y\":[76236196,74701340,62437557,56746085],\"text\":[\"qtr: Q1<br />litres: 76236196<br />factor(fyr): 2022<br />fyr: 2022\",\"qtr: Q2<br />litres: 74701340<br />factor(fyr): 2022<br />fyr: 2022\",\"qtr: Q3<br />litres: 62437557<br />factor(fyr): 2022<br />fyr: 2022\",\"qtr: Q4<br />litres: 56746085<br />factor(fyr): 2022<br />fyr: 2022\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(97,156,255,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2022\",\"legendgroup\":\"2022\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(97,156,255,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(97,156,255,1)\"}},\"frame\":null},{\"x\":[1,2,3,4],\"y\":[73520144,77363167,60246610,56763444],\"text\":[\"qtr: Q1<br />litres: 73520144<br />factor(fyr): 2023<br />fyr: 2023\",\"qtr: Q2<br />litres: 77363167<br />factor(fyr): 2023<br />fyr: 2023\",\"qtr: Q3<br />litres: 60246610<br />factor(fyr): 2023<br />fyr: 2023\",\"qtr: Q4<br />litres: 56763444<br />factor(fyr): 2023<br />fyr: 2023\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(219,114,251,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2023\",\"legendgroup\":\"2023\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(219,114,251,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(219,114,251,1)\"}},\"frame\":null},{\"x\":[1],\"y\":[70856430],\"text\":\"qtr: Q1<br />litres: 70856430<br />factor(fyr): 2024<br />fyr: 2024\",\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(255,97,195,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2024\",\"legendgroup\":\"2024\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(255,97,195,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(255,97,195,1)\"}},\"frame\":null},{\"x\":[1,2,3,4],\"y\":[78629398.888888896,79909444.875,66164474.75,59327624.25],\"text\":[\"qtr: Q1<br />avglitres: 78629399<br />factor(fyr): black\",\"qtr: Q2<br />avglitres: 79909445<br />factor(fyr): black\",\"qtr: Q3<br />avglitres: 66164475<br />factor(fyr): black\",\"qtr: Q4<br />avglitres: 59327624<br />factor(fyr): black\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":5.6692913385826778,\"color\":\"rgba(0,0,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":44.493150684931507,\"r\":7.3059360730593621,\"b\":26.301369863013704,\"l\":43.105022831050235},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Litres Comparison by Quarter (fiscal yr end Mar 31)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,4.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"Q1\",\"Q2\",\"Q3\",\"Q4\"],\"tickvals\":[1,2,3,4],\"categoryorder\":\"array\",\"categoryarray\":[\"Q1\",\"Q2\",\"Q3\",\"Q4\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0,83049030.099999994],\"tickmode\":\"array\",\"ticktext\":[\"0M\",\"20M\",\"40M\",\"60M\",\"80M\"],\"tickvals\":[0,20000000,40000000,60000000,80000000],\"categoryorder\":\"array\",\"categoryarray\":[\"0M\",\"20M\",\"40M\",\"60M\",\"80M\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"litres\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"fiscal yr\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"cd674ca32f63\":{\"x\":{},\"y\":{},\"colour\":{},\"type\":\"scatter\"},\"cd676d7c33e3\":{\"x\":{},\"y\":{},\"colour\":{}},\"cd677532b43c\":{\"x\":{},\"y\":{},\"colour\":{}}},\"cur_data\":\"cd674ca32f63\",\"visdat\":{\"cd674ca32f63\":[\"function (y) \",\"x\"],\"cd676d7c33e3\":[\"function (y) \",\"x\"],\"cd677532b43c\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n\nBC LDB fiscal yr ends Mar 31\n:::\n:::\n\n\nThe different pattern compared to \\$ sales likely represents the shift in drinking habits with the seasons:\n\n-   peak volume (litres) is in Q2 - beer season, and beer, along with refreshment beverages, are consumer in higher volumes than the other types.\n-   Q3, which is usually even with Q2 in \\$ sales, has a consistent drop in litre volume compared to Q2, due to shift away from beer/refreshments beverages toward wine and spirits.\n\nPatterns by beverage type are looked at more below.\n\nPercentage changes from one quarter to the next reflect the different quarter-by-quarter patterns for litres.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nch_title <- \"Distribution of % Change in Litres Between Quarters\"\nplot <- trend_qtr %>% ggplot(aes(y=pc_chg_litres, x=qtr))+\n  geom_boxplot(fill=bar_col)+\n  scale_y_continuous(labels=percent_format())+\n  geom_hline(yintercept = 0, linetype='dotted')+\n  labs(title=ch_title, x=\"\",y=\"% chg from prev quarter\")\nggplotly(plot)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-8196712c2877bd484376\" style=\"width:100%;height:433px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-8196712c2877bd484376\">{\"x\":{\"data\":[{\"x\":[1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4],\"y\":[null,0.35429583825164812,0.37434279298270701,0.32424314742353721,0.336484354007905,0.25204126802269156,0.3462500201091121,0.29559852455019575,0.24827573887165832,-0.0043990771492907754,-0.0065167166913328023,0.00018747167449340019,0.0049341773052617999,-0.028713202082407241,0.038945648659983734,-0.020132903798085633,0.052271701208855159,-0.11676171458737694,-0.17122161858518559,-0.13831590422425355,-0.1783416945716999,-0.15675145355974862,-0.23360724250505271,-0.16417085690832323,-0.22124943514786566,-0.15580482582224098,-0.11654414184119199,-0.13267789980444411,-0.1134770355059106,-0.080880572465978351,-0.061522722244100714,-0.091154623490473874,-0.057815136818486601],\"hoverinfo\":\"y\",\"type\":\"box\",\"fillcolor\":\"rgba(8,29,88,1)\",\"marker\":{\"opacity\":null,\"outliercolor\":\"rgba(0,0,0,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,1)\"},\"size\":5.6692913385826778},\"line\":{\"color\":\"rgba(51,51,51,1)\",\"width\":1.8897637795275593},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[0.40000000000000002,4.5999999999999996],\"y\":[0,0],\"text\":\"yintercept: 0\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,1)\",\"dash\":\"dot\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":44.493150684931507,\"r\":7.3059360730593621,\"b\":26.301369863013704,\"l\":48.949771689497723},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Distribution of % Change in Litres Between Quarters\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,4.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"Q1\",\"Q2\",\"Q3\",\"Q4\"],\"tickvals\":[1,2,3,4],\"categoryorder\":\"array\",\"categoryarray\":[\"Q1\",\"Q2\",\"Q3\",\"Q4\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-0.26400474427944071,0.404740294757095],\"tickmode\":\"array\",\"ticktext\":[\"-20%\",\"0%\",\"20%\",\"40%\"],\"tickvals\":[-0.20000000000000001,0,0.20000000000000001,0.40000000000000008],\"categoryorder\":\"array\",\"categoryarray\":[\"-20%\",\"0%\",\"20%\",\"40%\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"% chg from prev quarter\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"cd677082dfa6\":{\"x\":{},\"y\":{},\"type\":\"box\"},\"cd67202944ff\":{\"yintercept\":{}}},\"cur_data\":\"cd677082dfa6\",\"visdat\":{\"cd677082dfa6\":[\"function (y) \",\"x\"],\"cd67202944ff\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n-   Q1 (Apr-May-Jun) typically has around 35% increase over previous Q4\n-   Q2 (Jul-Aug-Sep) tends to be even or slight increase over Q1.\n-   Q3 (Oct-Nov-Dec) big drop around 15% range compared to Q2.\n-   Q4 (Jan-Feb-Mar) usually another \\~15% from Q3 to Q4.\n\n### By Major Beverage Type\n\nLet's look at beverage types to see what is going on below the surface of overall trends.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# quarters at cat_type level\ntrend_qtr_cat <- lmr_data %>% group_by(year, fyr, fy_qtr, start_qtr_dt, qtr, type) %>%\n  summarize(netsales=sum(netsales),\n            litres=sum(litres)\n            )\ntrend_qtr_cat$type <- as.factor(trend_qtr_cat$type)\n\ntrend_qtrs_cat <- trend_qtr_cat %>% group_by(qtr, type) %>% \n  summarize(\n    avg_netsales=mean(netsales),\n    avg_litres=mean(litres),\n    max_litres=max(litres)\n  )\ntrend_qtrs_cat$type <- as.factor(trend_qtrs_cat$type)\n```\n:::\n\n\n#### \\$ Sales\n\nLooking at quarter sales by beverage type reveals patterns we suspected earlier:\n\n-   **Beer and refreshment beverages tend to peak in Q2** and decline in Q3 and Q4.\n-   **Wine and, especially, spirits peak in Q3** and offset the decline in revenue from beer and refreshment beverages.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nch_title <- \"Comparison of Qtrly $ Sales by Beverage Type\"\ntrend_qtr_cat %>% ggplot(aes(x=qtr, y=netsales, color=factor(fyr), group=fyr))+\n  geom_line()+\n  geom_point()+\n  geom_line(data=trend_qtrs_cat, aes(x=qtr, y=avg_netsales), color='black', group=1, size=1.2)+\n  facet_grid(type~., scales='free_y')+\n  scale_y_continuous(labels=label_comma(scale=1e-6, prefix=\"$\", suffix=\"M\"), \n                     limits=c(0,NA))+\n  labs(title=ch_title, x=\"\", color=\"fiscal yr\", y=\"$ Sales (upper limit varies)\")+theme(panel.border = element_rect(fill=NA))\n```\n\n::: {.cell-output-display}\n![black line = average](index_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=480}\n:::\n:::\n\n\nStacked chart highlights the shifts between Q2 and Q3:\n\n-   decline in \\$ sales of Beer and Refreshment Beverages in Q3 almost completely offset by increase in wine and spirits.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntrend_qtrs_cat$type <- fct_reorder(trend_qtrs_cat$type, trend_qtrs_cat$avg_netsales)\n\nch_title <- \"Breakdown in $ Sales per Qtr by Category\"\nplot <- trend_qtrs_cat %>% ggplot(aes(x=qtr, y=avg_netsales, fill=type))+\n  #geom_col(position='fill')+\n  geom_col()+\n  scale_y_continuous(labels=label_comma(scale=1e-6, prefix=\"$\", suffix=\"M\"), expand=expansion(add=c(0,0.1)))+\n  scale_fill_manual(values=type_color)+\n  labs(title=ch_title, x=\"\",y=\"Average Net Sales in Qtr (2015-2023)\")+\n  theme(axis.ticks.x = element_blank())\nggplotly(plot)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-61aeddc43238e1972d3d\" style=\"width:100%;height:780px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-61aeddc43238e1972d3d\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036],\"base\":[0,0,0,0],\"x\":[1,2,3,4],\"y\":[301022112.8888889,303455271.5,252323804.625,227248959.375],\"text\":[\"qtr: Q1<br />avg_netsales: 301022113<br />type: Beer\",\"qtr: Q2<br />avg_netsales: 303455272<br />type: Beer\",\"qtr: Q3<br />avg_netsales: 252323805<br />type: Beer\",\"qtr: Q4<br />avg_netsales: 227248959<br />type: Beer\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(252,78,42,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Beer\",\"legendgroup\":\"Beer\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":39.622526636225267,\"r\":7.3059360730593621,\"b\":21.430745814307464,\"l\":54.794520547945211},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Breakdown in $ Sales per Qtr by Category\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,4.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"Q1\",\"Q2\",\"Q3\",\"Q4\"],\"tickvals\":[1,2,3,4],\"categoryorder\":\"array\",\"categoryarray\":[\"Q1\",\"Q2\",\"Q3\",\"Q4\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0,303455271.60000002],\"tickmode\":\"array\",\"ticktext\":[\"$0M\",\"$100M\",\"$200M\",\"$300M\"],\"tickvals\":[0,100000000,200000000,300000000],\"categoryorder\":\"array\",\"categoryarray\":[\"$0M\",\"$100M\",\"$200M\",\"$300M\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Average Net Sales in Qtr (2015-2023)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"type\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"cd674e03cd37\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"bar\"}},\"cur_data\":\"cd674e03cd37\",\"visdat\":{\"cd674e03cd37\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n#### Litres\n\nSimilar quarter-over-quarter patterns can be seen when looking at litres sold, although the overall differences from one quarter to the next - especially Q2 to Q3 - are larger when measured in litres, since Beer and Refreshment Beverages are consumed in larger quantities than Wine and Spirits.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nch_title <- \"Comparison of Qtrly volume by Category\"\ntrend_qtr_cat %>% ggplot(aes(x=qtr, y=litres, color=factor(fyr), group=fyr))+\n  geom_line()+\n  geom_point()+\n  facet_grid(type~., scales='free_y')+\n  scale_y_continuous(labels=label_comma(scale=1e-6, suffix=\"M\"), \n                     limits=c(0,NA))+\n  labs(title=ch_title, x=\"\", color=\"fiscal yr\", y=\"litres (upper limit varies)\")+theme(panel.border = element_rect(fill=NA))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){fig-align='center' width=480}\n:::\n\n```{.r .cell-code}\n  #+ theme(panel.border = element_line())\n```\n:::\n\n\n-   Beer and, even more-so, refreshment beverages drop from Q1-Q2 (Apr-Sep) to Q3-Q4 (Oct-Mar).\n-   Wine, Spirits have small peak in Q3 (Oct-Dec) - holiday season.\n\nThis pattern shows up clearly when looking at the average % breakdown in litres by beverage type:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrend_qtrs_cat$type <- fct_reorder(trend_qtrs_cat$type, trend_qtrs_cat$avg_litres)\n\nch_title <- \"Breakdown in Avg Litre per Qtr by Category\"\ntrend_qtrs_cat %>% ggplot(aes(x=qtr, y=avg_litres, fill=type))+\n  geom_col(position='fill')+\n  scale_y_continuous(labels=percent_format(), expand=expansion(mult = c(0,0.1)))+\n  scale_fill_manual(values=type_color)+\n  labs(title=ch_title, x=\"\",y=\"Average % Breakdown by Quarter (2015-2023\")+\n  theme(axis.ticks.x = element_blank())\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=576}\n:::\n:::\n\n\nThe bulge in % share for Wine and Spirits in Q3 (Sep-Dec), at the expense of Beer and Refreshment Beverages, is apparent.\n\n### Part 2 Wrap-up and Next Up\n\nThis concludes our look at quarter patterns, including quarters from mid-2015 to mid-2023.\n\n#### Next-up:\n\n1.  **Category trends and patterns:** closer look at each of the major beverage types, exploring categories and sub-categories within them, as reported in the Liquor Market Review.\n2.  **Category 1: Beer:** start with beer, because...beer. ;)\n\n### Footnotes\n\nNotes on 'net \\$ sales':\n\n-   the report says \"**Net dollar value is based on the price paid by the customer** and excludes any applicable taxes.\"\n-   calculating average **net dollar value per litre for beverage categories gives unrealistically low numbers** compared to retail prices in BC liquor stores. (*Beer at average \\$4/litre? Not even the cheapest beer on the [BC Liquor Stores](https://www.bcliquorstores.com/product-catalogue?category=beer&sort=currentPrice:desc&page=1) website.*)\n-   there is likely additional factors related to BC LDB pricing structure, wholesaling, etc.\n-   best to **consider average net dollar value per litre referred to below as relative indicator**.\n\n## \n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}