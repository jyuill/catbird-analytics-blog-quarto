{
  "hash": "bf37246d8cfc9be6ed67154eeea5a8f2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"BC Liquor Sales Analysis: Beer 2016-2022\"\nauthor: John Yuill\ndate: '2023-11-26'\ncategories: [liquor stats, reporting, analysis]\ndescription-meta: BC Liquor Market Review beer sales data exploration and analysis covering the years 2016 to 2022 with trends, patterns and observations.\ndraft: true\n#image: .png \ntoc: true\ntoc-depth: 4\ntoc-location: left\ndate-modified: '2024-04-28'\nfig-height: 4\nfig-width: 6\ncode-fold: true\nexecute:\n  echo: true\n  error: false\n  warning: false\n---\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# function for determining how many complete yrs of data, used in \nfn_yr_qtr <- function(data) {\n  # create variable to identify/remove partial yrs by counting qtrs and select yrs with 4\n  yr_qtr <- data %>% group_by(year, qtr) %>% summarize(count=1)\n  yr_qtr <- yr_qtr %>% group_by(year) %>% summarize(count=n()) %>% filter(count==4)\n  data_cy <- data %>% filter(year %in% yr_qtr$year)\n  return(data_cy)\n}\nlmr_data_cy <- fn_yr_qtr(lmr_data)\n```\n:::\n\n\nThis is a continuation of a previous analysis of [annual liquor sales in British Columbia](../bc-liquor-market-review-2023-06-pt01-annual-trends) and [quarter-of-year patterns in BC liquor sales](../bc-liquor-market-review-2023-06-pt02-quarterly-trends), based on data from **British Columbia Liquor Distribution Board** '[**Liquor Market Review**](https://www.bcldb.com/publications/liquor-market-review)'. The Liquor Market Review is released on a quarterly basis, covering dollar and litre sales across major alcoholic beverage categories: here we focus on **BEER**!\n\nData shown here goes back to beginning of 2016 (BC LDB fiscal yr 2016 Q4).\n\n::: {.callout-note icon=\"false\"}\n**As mentioned in previous articles:** *my expertise is in data analysis, not the liquor industry, so the emphasis is on exploring what the data can tell us. Industry-insider context may be lacking. In the interest of promoting data analysis and learning, I am sharing most of the R code used to process the data - hence the expandable 'Code' options.*\n:::\n\n## Beer Sales Trends in BC\n\n### Overview\n\nWe'll start with an annual overview across all beer categories and then look at trends for individual categories further down below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## function for summarizing data on various dimensions\nfn_trend_yr_smry <- function(data, grp1=year, grp2) {\n  grp1 <- enquo(grp1)\n  grp2 <- enquo(grp2)\n\n  # ttls for yr to use for % of ttl calcs used with various dimensions\n  trend_yr_ttl <- data %>% group_by(!!grp1) %>% summarize(\n    ttl_netsales=sum(netsales),\n    ttl_litres=sum(litres)\n  )\n  \n  # summarize data by cal. yr & secondary dimension - if available\n  trend_yr <- data %>% group_by(!!grp1, !!grp2) %>% summarize(\n    netsales=sum(netsales),\n    litres=sum(litres)\n  )\n  \n  # add % chg YoY, $/l\n  # determine lag based on how many items in dimension (must be consistent)\n  trend_yr <- trend_yr %>% ungroup()\n  if(!is.null(grp2)) {\n    grp <- trend_yr %>% group_by(!!grp2) %>% summarize(count=n())\n    n_items <- nrow(grp)\n  } else {\n    n_items <- 1\n  }\n  # calc % chg YoY, by dimension if applicable\n  trend_yr <- trend_yr %>% mutate(\n    pc_chg_sales=netsales/lag(netsales, n=n_items)-1,\n    pc_chg_litres=litres/lag(litres, n=n_items)-1,\n    dollar_per_litre=netsales/litres,\n    pc_chg_d_per_l=dollar_per_litre/lag(dollar_per_litre)-1\n  )\n  \n  # calc cumulative chg over period - based on no. of periods and dimensions (if applciable)\n  n_yrs <- max(trend_yr$year)-min(trend_yr$year)\n  trend_yr <- trend_yr %>% mutate(\n    pc_chg_sales_cum = netsales/lag(netsales, n=(n_yrs*n_items))-1,\n    pc_chg_lt_cum =  litres/lag(litres, n=(n_yrs*n_items))-1\n  )\n  \n  # calc % of annual total for each dimension (will be 1 for yr, if no additional dimensions)\n  trend_yr <- left_join(trend_yr, trend_yr_ttl, by='year')\n  # calc %\n  trend_yr <- trend_yr %>% mutate(\n    litres_pc=litres/ttl_litres,\n    netsales_pc=netsales/ttl_netsales\n)\n  return(trend_yr)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntrend_yr <- fn_trend_yr_smry(data=lmr_data_cy)\n```\n:::\n\n\nBeer sales have been pretty stable over the last few years, with net \\$ sales peaking in 2017, recovering in 2022 in line with inflation. Overall **slight downward trend**, most noticeable in litre consumption.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# dual axis - not usually recommended but works ok here \n# - using ggplot because doesn't work well with ggplotly\nch_title <- \"BC Beer: Net Sales $ + Litre Sales trend\"\nplot <- trend_yr %>% ggplot(aes(x=as.factor(year), y=netsales, group=1))+\n  geom_line(color=bar_col, size=2)+\n  geom_smooth(aes(y=netsales), method='lm', se=FALSE, color='brown', linetype='solid', size=1)+\n  geom_point(aes(y=netsales), color=bar_col, size=3)+\n  geom_line(aes(x=as.factor(year), y=litres*3), size=2, color='royalblue')+\n  geom_smooth(aes(y=litres*3), method='lm', se=FALSE, color='brown')+\n  geom_point(aes(x=as.factor(year), y=litres*3), size=3, color='royalblue')+\n  scale_y_continuous(name='net $ sales',\n                      labels=comma_format(prefix=\"$\", scale=1e-9,suffix=\"B\"), \n                     expand=expansion(mult=c(0,0.1)), \n                     limits=c(0,max(trend_yr$netsales)),\n                     sec.axis = sec_axis(trans=~./3, name='litres',\n                                         labels=comma_format(scale=1e-6, \n                                                             suffix=\"M\")))+\n  labs(title=ch_title, x=\"\")+\n  theme_classic()+\n  theme(\n    axis.title.y = element_text(color = bar_col, size=13),\n    axis.title.y.right = element_text(color = 'royalblue', size=13)\n  )\n\nplot\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/sales dual-axis-1.png){width=576}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## aggregate data by quarter\ntrend_yr_qtr <- lmr_data_cy %>% group_by(end_qtr_dt) %>% summarize(\n  netsales=sum(netsales),\n  litres=sum(litres)\n) \n```\n:::\n\n\nBreaking out **litre sales** by quarter confirms the steady **downward trend** within seasonal cycles**.**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nch_title <- \"BC Beer Litre Sales by Qtr, with Trend\"\nplot <- trend_yr_qtr %>% ggplot(aes(x=end_qtr_dt, y=litres, group=1))+\n  geom_line(color=bar_col, size=1.4)+\n  #geom_point(aes(y=litres), color=bar_col, size=3)+\n  geom_smooth(method='lm', se=FALSE)+\n  scale_y_continuous(labels=comma_format(scale=1e-6,suffix=\"M\"), \n                     expand=expansion(mult=c(0,0.1)), \n                     limits=c(0,max(trend_yr_qtr$litres)))+\n  labs(title=ch_title, x=\"\")\nggplotly(plot)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-e1d898cb56a6641391c4\" style=\"width:100%;height:433px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-e1d898cb56a6641391c4\">{\"x\":{\"data\":[{\"x\":[16891,16955,17074,17166,17256,17347,17439,17531,17621,17712,17804,17896,17986,18077,18169,18261,18352,18443,18535,18627,18717,18808,18900,18992,19082,19173,19265,19357,19447,19538,19630,19722],\"y\":[61322665,83049030,82507823,68380700,60411330,83025876,83041441,71555489,62061657,82184724,82590238,67860955,60160295,80403293,78094657,65853206,60526961,75782253,78733642,60340893,56628557,76236196,74701340,62437557,56746085,73520144,77363222,60246486,56763039,70862244,71402753,56950699],\"text\":[\"end_qtr_dt: 2016-03-31<br />litres: 61322665\",\"end_qtr_dt: 2016-06-03<br />litres: 83049030\",\"end_qtr_dt: 2016-09-30<br />litres: 82507823\",\"end_qtr_dt: 2016-12-31<br />litres: 68380700\",\"end_qtr_dt: 2017-03-31<br />litres: 60411330\",\"end_qtr_dt: 2017-06-30<br />litres: 83025876\",\"end_qtr_dt: 2017-09-30<br />litres: 83041441\",\"end_qtr_dt: 2017-12-31<br />litres: 71555489\",\"end_qtr_dt: 2018-03-31<br />litres: 62061657\",\"end_qtr_dt: 2018-06-30<br />litres: 82184724\",\"end_qtr_dt: 2018-09-30<br />litres: 82590238\",\"end_qtr_dt: 2018-12-31<br />litres: 67860955\",\"end_qtr_dt: 2019-03-31<br />litres: 60160295\",\"end_qtr_dt: 2019-06-30<br />litres: 80403293\",\"end_qtr_dt: 2019-09-30<br />litres: 78094657\",\"end_qtr_dt: 2019-12-31<br />litres: 65853206\",\"end_qtr_dt: 2020-03-31<br />litres: 60526961\",\"end_qtr_dt: 2020-06-30<br />litres: 75782253\",\"end_qtr_dt: 2020-09-30<br />litres: 78733642\",\"end_qtr_dt: 2020-12-31<br />litres: 60340893\",\"end_qtr_dt: 2021-03-31<br />litres: 56628557\",\"end_qtr_dt: 2021-06-30<br />litres: 76236196\",\"end_qtr_dt: 2021-09-30<br />litres: 74701340\",\"end_qtr_dt: 2021-12-31<br />litres: 62437557\",\"end_qtr_dt: 2022-03-31<br />litres: 56746085\",\"end_qtr_dt: 2022-06-30<br />litres: 73520144\",\"end_qtr_dt: 2022-09-30<br />litres: 77363222\",\"end_qtr_dt: 2022-12-31<br />litres: 60246486\",\"end_qtr_dt: 2023-03-31<br />litres: 56763039\",\"end_qtr_dt: 2023-06-30<br />litres: 70862244\",\"end_qtr_dt: 2023-09-30<br />litres: 71402753\",\"end_qtr_dt: 2023-12-31<br />litres: 56950699\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":5.2913385826771648,\"color\":\"rgba(8,29,88,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[16891,16926.835443037973,16962.67088607595,16998.506329113923,17034.3417721519,17070.177215189873,17106.01265822785,17141.848101265823,17177.683544303796,17213.518987341773,17249.354430379746,17285.189873417723,17321.025316455696,17356.860759493669,17392.696202531646,17428.531645569619,17464.367088607596,17500.202531645569,17536.037974683546,17571.873417721519,17607.708860759492,17643.544303797469,17679.379746835442,17715.215189873419,17751.050632911392,17786.886075949365,17822.721518987342,17858.556962025315,17894.392405063292,17930.227848101265,17966.063291139242,18001.898734177215,18037.734177215189,18073.569620253165,18109.405063291139,18145.240506329115,18181.075949367088,18216.911392405062,18252.746835443038,18288.582278481012,18324.417721518988,18360.253164556962,18396.088607594938,18431.924050632912,18467.759493670885,18503.594936708861,18539.430379746835,18575.265822784811,18611.101265822785,18646.936708860761,18682.772151898735,18718.607594936708,18754.443037974685,18790.278481012658,18826.113924050635,18861.949367088608,18897.784810126581,18933.620253164558,18969.455696202531,19005.291139240508,19041.126582278481,19076.962025316454,19112.797468354431,19148.632911392404,19184.468354430381,19220.303797468354,19256.139240506331,19291.974683544304,19327.810126582277,19363.645569620254,19399.481012658227,19435.316455696204,19471.151898734177,19506.987341772154,19542.822784810127,19578.6582278481,19614.493670886077,19650.32911392405,19686.164556962027,19722],\"y\":[75500303.555355519,75362329.646296203,75224355.737236872,75086381.828177571,74948407.91911824,74810434.010058925,74672460.100999609,74534486.191940293,74396512.282880977,74258538.373821646,74120564.464762345,73982590.555703014,73844616.646643698,73706642.737584382,73568668.828525066,73430694.91946575,73292721.01040642,73154747.101347119,73016773.192287788,72878799.283228472,72740825.374169156,72602851.46510984,72464877.556050524,72326903.646991193,72188929.737931892,72050955.828872576,71912981.919813246,71775008.01075393,71637034.101694614,71499060.192635298,71361086.283575967,71223112.374516666,71085138.46545735,70947164.556398019,70809190.647338703,70671216.738279387,70533242.829220071,70395268.920160756,70257295.01110144,70119321.102042124,69981347.192982793,69843373.283923477,69705399.374864161,69567425.465804845,69429451.556745529,69291477.647686213,69153503.738626897,69015529.829567567,68877555.920508251,68739582.011448935,68601608.102389619,68463634.193330303,68325660.284270972,68187686.375211671,68049712.46615234,67911738.557093024,67773764.648033723,67635790.738974392,67497816.829915076,67359842.920855746,67221869.011796445,67083895.102737129,66945921.193677805,66807947.284618489,66669973.375559166,66531999.46649985,66394025.557440527,66256051.648381211,66118077.739321902,65980103.830262579,65842129.921203263,65704156.01214394,65566182.103084624,65428208.1940253,65290234.284965985,65152260.375906676,65014286.466847345,64876312.557788037,64738338.648728713,64600364.739669397],\"text\":[\"end_qtr_dt: 16891.00<br />litres: 75500304\",\"end_qtr_dt: 16926.84<br />litres: 75362330\",\"end_qtr_dt: 16962.67<br />litres: 75224356\",\"end_qtr_dt: 16998.51<br />litres: 75086382\",\"end_qtr_dt: 17034.34<br />litres: 74948408\",\"end_qtr_dt: 17070.18<br />litres: 74810434\",\"end_qtr_dt: 17106.01<br />litres: 74672460\",\"end_qtr_dt: 17141.85<br />litres: 74534486\",\"end_qtr_dt: 17177.68<br />litres: 74396512\",\"end_qtr_dt: 17213.52<br />litres: 74258538\",\"end_qtr_dt: 17249.35<br />litres: 74120564\",\"end_qtr_dt: 17285.19<br />litres: 73982591\",\"end_qtr_dt: 17321.03<br />litres: 73844617\",\"end_qtr_dt: 17356.86<br />litres: 73706643\",\"end_qtr_dt: 17392.70<br />litres: 73568669\",\"end_qtr_dt: 17428.53<br />litres: 73430695\",\"end_qtr_dt: 17464.37<br />litres: 73292721\",\"end_qtr_dt: 17500.20<br />litres: 73154747\",\"end_qtr_dt: 17536.04<br />litres: 73016773\",\"end_qtr_dt: 17571.87<br />litres: 72878799\",\"end_qtr_dt: 17607.71<br />litres: 72740825\",\"end_qtr_dt: 17643.54<br />litres: 72602851\",\"end_qtr_dt: 17679.38<br />litres: 72464878\",\"end_qtr_dt: 17715.22<br />litres: 72326904\",\"end_qtr_dt: 17751.05<br />litres: 72188930\",\"end_qtr_dt: 17786.89<br />litres: 72050956\",\"end_qtr_dt: 17822.72<br />litres: 71912982\",\"end_qtr_dt: 17858.56<br />litres: 71775008\",\"end_qtr_dt: 17894.39<br />litres: 71637034\",\"end_qtr_dt: 17930.23<br />litres: 71499060\",\"end_qtr_dt: 17966.06<br />litres: 71361086\",\"end_qtr_dt: 18001.90<br />litres: 71223112\",\"end_qtr_dt: 18037.73<br />litres: 71085138\",\"end_qtr_dt: 18073.57<br />litres: 70947165\",\"end_qtr_dt: 18109.41<br />litres: 70809191\",\"end_qtr_dt: 18145.24<br />litres: 70671217\",\"end_qtr_dt: 18181.08<br />litres: 70533243\",\"end_qtr_dt: 18216.91<br />litres: 70395269\",\"end_qtr_dt: 18252.75<br />litres: 70257295\",\"end_qtr_dt: 18288.58<br />litres: 70119321\",\"end_qtr_dt: 18324.42<br />litres: 69981347\",\"end_qtr_dt: 18360.25<br />litres: 69843373\",\"end_qtr_dt: 18396.09<br />litres: 69705399\",\"end_qtr_dt: 18431.92<br />litres: 69567425\",\"end_qtr_dt: 18467.76<br />litres: 69429452\",\"end_qtr_dt: 18503.59<br />litres: 69291478\",\"end_qtr_dt: 18539.43<br />litres: 69153504\",\"end_qtr_dt: 18575.27<br />litres: 69015530\",\"end_qtr_dt: 18611.10<br />litres: 68877556\",\"end_qtr_dt: 18646.94<br />litres: 68739582\",\"end_qtr_dt: 18682.77<br />litres: 68601608\",\"end_qtr_dt: 18718.61<br />litres: 68463634\",\"end_qtr_dt: 18754.44<br />litres: 68325660\",\"end_qtr_dt: 18790.28<br />litres: 68187686\",\"end_qtr_dt: 18826.11<br />litres: 68049712\",\"end_qtr_dt: 18861.95<br />litres: 67911739\",\"end_qtr_dt: 18897.78<br />litres: 67773765\",\"end_qtr_dt: 18933.62<br />litres: 67635791\",\"end_qtr_dt: 18969.46<br />litres: 67497817\",\"end_qtr_dt: 19005.29<br />litres: 67359843\",\"end_qtr_dt: 19041.13<br />litres: 67221869\",\"end_qtr_dt: 19076.96<br />litres: 67083895\",\"end_qtr_dt: 19112.80<br />litres: 66945921\",\"end_qtr_dt: 19148.63<br />litres: 66807947\",\"end_qtr_dt: 19184.47<br />litres: 66669973\",\"end_qtr_dt: 19220.30<br />litres: 66531999\",\"end_qtr_dt: 19256.14<br />litres: 66394026\",\"end_qtr_dt: 19291.97<br />litres: 66256052\",\"end_qtr_dt: 19327.81<br />litres: 66118078\",\"end_qtr_dt: 19363.65<br />litres: 65980104\",\"end_qtr_dt: 19399.48<br />litres: 65842130\",\"end_qtr_dt: 19435.32<br />litres: 65704156\",\"end_qtr_dt: 19471.15<br />litres: 65566182\",\"end_qtr_dt: 19506.99<br />litres: 65428208\",\"end_qtr_dt: 19542.82<br />litres: 65290234\",\"end_qtr_dt: 19578.66<br />litres: 65152260\",\"end_qtr_dt: 19614.49<br />litres: 65014286\",\"end_qtr_dt: 19650.33<br />litres: 64876313\",\"end_qtr_dt: 19686.16<br />litres: 64738339\",\"end_qtr_dt: 19722.00<br />litres: 64600365\"],\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"fitted values\",\"line\":{\"width\":3.7795275590551185,\"color\":\"rgba(51,102,255,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":44.493150684931507,\"r\":7.3059360730593621,\"b\":26.301369863013704,\"l\":43.105022831050235},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"BC Beer Litre Sales by Qtr, with Trend\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[16749.450000000001,19863.549999999999],\"tickmode\":\"array\",\"ticktext\":[\"2016\",\"2018\",\"2020\",\"2022\",\"2024\"],\"tickvals\":[16801,17532,18262,18993,19723],\"categoryorder\":\"array\",\"categoryarray\":[\"2016\",\"2018\",\"2020\",\"2022\",\"2024\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0,91353933],\"tickmode\":\"array\",\"ticktext\":[\"0M\",\"25M\",\"50M\",\"75M\"],\"tickvals\":[0,25000000,50000000,75000000],\"categoryorder\":\"array\",\"categoryarray\":[\"0M\",\"25M\",\"50M\",\"75M\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"litres\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"a765928810b\":{\"x\":{},\"y\":{},\"type\":\"scatter\"},\"a765422ffddf\":{\"x\":{},\"y\":{}}},\"cur_data\":\"a765928810b\",\"visdat\":{\"a765928810b\":[\"function (y) \",\"x\"],\"a765422ffddf\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nThe flat trend/recent increase in net \\$ sales vs downward trend in litre sales shows up in gradual uptrend in net \\$ per litre sales. Brewers are selling fewer litres but getting more money for each of them (on average).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nch_title <- \"BC Beer: Net $/Litre trend\"\nplot <- trend_yr %>% ggplot(aes(x=as.factor(year), y=dollar_per_litre, group=1))+\n  geom_line(color=bar_col, size=2)+\n  geom_smooth(aes(y=dollar_per_litre), method='lm', se=FALSE, color='brown', linetype='solid', size=1)+\n  geom_point(aes(y=dollar_per_litre), color=bar_col, size=3)+\n  scale_y_continuous(name='Net $/litre',\n                      labels=comma_format(prefix=\"$\"), \n                     expand=expansion(mult=c(0,0.1)), \n                     limits=c(0,max(trend_yr$dollar_per_litre)))+\n  labs(title=ch_title, x=\"\")+\n  theme_classic()+\n  theme(\n    axis.title.y = element_text(color = bar_col, size=13)\n  )\n\nplot\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=576}\n:::\n:::\n\n\n### Sales by Category\n\nBC LDB puts beer into 3 major categories for purposes of the Liquor Market Report:\n\n-   **Domestic - BC Beer:** beer produced in BC.\n-   **Domestic - Other Province Beer:** beer produced in Canada outside BC.\n-   **Import Beer:** beer imported from outside Canada.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# summarize data by year and major category - using function\ntrend_yr_cat <- fn_trend_yr_smry(data=lmr_data_cy, grp2=category)\n\n## simplify category names\n#unique(trend_yr_cat$category)\ntrend_yr_cat <- trend_yr_cat %>% mutate(\n  category=case_when(\n    category=='Domestic - BC Beer' ~ 'BC',\n    category=='Domestic - Other Province Beer' ~ 'Other Prov.',\n    category=='Import Beer' ~ 'Import'\n  )\n)\n```\n:::\n\n\n#### Litre sales\n\nLooking at **litre consumption** for these 3 main categories:\n\n-   volume drops in the BC and Import beer, with **other province beer actually increasing**.\n-   in % terms, litre market share for BC remained steady just under 80%, while **other provinces took their market share out of imports**.\n\n\n::: {.cell layout-ncol=\"2\"}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-875838b3e64d097b1087\" style=\"width:100%;height:325px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-875838b3e64d097b1087\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947],\"base\":[276228271,279503235,272244392,260747188,248667911,232790016,231154963,219828094],\"x\":[1,2,3,4,5,6,7,8],\"y\":[19031947,18530901,22453182,23764263,26715838,37213634,36720974,36150641],\"text\":[\"litres:  19,031,947 <br>cat: Other Prov.\",\"litres:  18,530,901 <br>cat: Other Prov.\",\"litres:  22,453,182 <br>cat: Other Prov.\",\"litres:  23,764,263 <br>cat: Other Prov.\",\"litres:  26,715,838 <br>cat: Other Prov.\",\"litres:  37,213,634 <br>cat: Other Prov.\",\"litres:  36,720,974 <br>cat: Other Prov.\",\"litres:  36,150,641 <br>cat: Other Prov.\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Other Prov.\",\"legendgroup\":\"Other Prov.\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947],\"base\":[229971335,232837354,230809520,221197743,214899460,210304493,209018471,200120911],\"x\":[1,2,3,4,5,6,7,8],\"y\":[46256936,46665881,41434872,39549445,33768451,22485523,22136492,19707183],\"text\":[\"litres:  46,256,936 <br>cat: Import\",\"litres:  46,665,881 <br>cat: Import\",\"litres:  41,434,872 <br>cat: Import\",\"litres:  39,549,445 <br>cat: Import\",\"litres:  33,768,451 <br>cat: Import\",\"litres:  22,485,523 <br>cat: Import\",\"litres:  22,136,492 <br>cat: Import\",\"litres:  19,707,183 <br>cat: Import\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,186,56,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Import\",\"legendgroup\":\"Import\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947],\"base\":[0,0,0,0,0,0,0,0],\"x\":[1,2,3,4,5,6,7,8],\"y\":[229971335,232837354,230809520,221197743,214899460,210304493,209018471,200120911],\"text\":[\"litres: 229,971,335 <br>cat: BC\",\"litres: 232,837,354 <br>cat: BC\",\"litres: 230,809,520 <br>cat: BC\",\"litres: 221,197,743 <br>cat: BC\",\"litres: 214,899,460 <br>cat: BC\",\"litres: 210,304,493 <br>cat: BC\",\"litres: 209,018,471 <br>cat: BC\",\"litres: 200,120,911 <br>cat: BC\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(97,156,255,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"BC\",\"legendgroup\":\"BC\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":48.146118721461193,\"r\":7.3059360730593621,\"b\":31.995975037917269,\"l\":34.337899543379002},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Beer Litre Sales by Cat.\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,8.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\",\"2023\"],\"tickvals\":[1,2,3,4,5,6,7,8],\"categoryorder\":\"array\",\"categoryarray\":[\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\",\"2023\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-45,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0,298034136.10000002],\"tickmode\":\"array\",\"ticktext\":[\"0M\",\"100M\",\"200M\"],\"tickvals\":[0,100000000,200000000],\"categoryorder\":\"array\",\"categoryarray\":[\"0M\",\"100M\",\"200M\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"category\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"a76579664721\":{\"x\":{},\"y\":{},\"fill\":{},\"text\":{},\"type\":\"bar\"}},\"cur_data\":\"a76579664721\",\"visdat\":{\"a76579664721\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-80efa11b5329ea851205\" style=\"width:100%;height:325px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-80efa11b5329ea851205\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947],\"base\":[0.93554178368858343,0.93782289086509207,0.92380941011750584,0.91647343923601865,0.90298687523496535,0.86217358913481357,0.86291798206570536,0.8587748275262006],\"x\":[1,2,3,4,5,6,7,8],\"y\":[0.064458216311416572,0.062177109134907926,0.076190589882494164,0.08352656076398135,0.097013124765034653,0.13782641086518643,0.13708201793429464,0.1412251724737994],\"text\":[\"share: 6%<br>cat: Other Prov.\",\"share: 6%<br>cat: Other Prov.\",\"share: 8%<br>cat: Other Prov.\",\"share: 8%<br>cat: Other Prov.\",\"share: 10%<br>cat: Other Prov.\",\"share: 14%<br>cat: Other Prov.\",\"share: 14%<br>cat: Other Prov.\",\"share: 14%<br>cat: Other Prov.\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Other Prov.\",\"legendgroup\":\"Other Prov.\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947],\"base\":[0.77887680418904248,0.78124391093240408,0.78320807622257527,0.77746516782552977,0.78036362269147563,0.7788950001231465,0.78028087681500113,0.78178724885096418],\"x\":[1,2,3,4,5,6,7,8],\"y\":[0.15666497949954095,0.15657897993268799,0.14060133389493057,0.13900827141048888,0.12262325254348971,0.08327858901166707,0.082637105250704224,0.076987578675236423],\"text\":[\"share: 16%<br>cat: Import\",\"share: 16%<br>cat: Import\",\"share: 14%<br>cat: Import\",\"share: 14%<br>cat: Import\",\"share: 12%<br>cat: Import\",\"share: 8%<br>cat: Import\",\"share: 8%<br>cat: Import\",\"share: 8%<br>cat: Import\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,186,56,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Import\",\"legendgroup\":\"Import\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947],\"base\":[0,0,0,0,0,0,0,0],\"x\":[1,2,3,4,5,6,7,8],\"y\":[0.77887680418904248,0.78124391093240408,0.78320807622257527,0.77746516782552977,0.78036362269147563,0.7788950001231465,0.78028087681500113,0.78178724885096418],\"text\":\"share: 78%<br>cat: BC\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(97,156,255,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"BC\",\"legendgroup\":\"BC\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":48.146118721461193,\"r\":7.3059360730593621,\"b\":31.995975037917269,\"l\":34.337899543379002},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Beer % Litre Sales by Cat.\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,8.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\",\"2023\"],\"tickvals\":[1,2,3,4,5,6,7,8],\"categoryorder\":\"array\",\"categoryarray\":[\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\",\"2023\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-45,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0,1],\"tickmode\":\"array\",\"ticktext\":[\"0%\",\"25%\",\"50%\",\"75%\",\"100%\"],\"tickvals\":[0,0.25,0.5,0.75,1],\"categoryorder\":\"array\",\"categoryarray\":[\"0%\",\"25%\",\"50%\",\"75%\",\"100%\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"category\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"a76533ce607b\":{\"x\":{},\"y\":{},\"fill\":{},\"text\":{},\"type\":\"bar\"}},\"cur_data\":\"a76533ce607b\",\"visdat\":{\"a76533ce607b\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n#### Year-over-Year % Changes\n\nThe year-over-year dynamics in litre consumption stand out even clearer when looking at % change:\n\n-   mostly stable for BC producers.\n-   **BIG gains by other Canadian provinces** - as high as almost 40% growth in 2021. Pandemic effect?\n-   **Imports as the big losers**, with over 30% loss in 2021. Possibly related to pandemic and related supply chain issues?\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# YoY % chg chart\nch_title <- \"Year-over-Year % change in Litre Sales\"\nplot <- trend_yr_cat %>% ggplot(aes(x=year, y=pc_chg_litres,\n                                    text=paste0(year,\": \",\n                                                round(pc_chg_litres*100),\"%\")))+\n  geom_col(aes(fill=pc_chg_litres>0), show.legend=FALSE)+\n  scale_fill_manual(values=c(\"TRUE\"=posneg_col[2], \"FALSE\"=posneg_col[1]))+\n  facet_grid(.~category)+\n  scale_y_continuous(labels=percent_format())+\n  geom_hline(yintercept=0)+\n  labs(title=ch_title, x=\"\", y=\"Litre sales - % chg\")+\n  theme_bw()+\n  theme(panel.grid = element_blank(),\n        strip.background = element_rect(fill=\"lightblue\"),\n        legend.position = \"none\")\nggplotly(plot, tooltip=\"text\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-d45bd2bd3de343479045\" style=\"width:100%;height:433px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-d45bd2bd3de343479045\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095],\"base\":[-0.0087092297054707224,-0.041643763220858498,-0.028473540980027079,-0.021381938325950145,-0.0061150476704271428,-0.042568295315871918],\"x\":[2018,2019,2020,2021,2022,2023],\"y\":[0.0087092297054707224,0.041643763220858498,0.028473540980027079,0.021381938325950145,0.0061150476704271428,0.042568295315871918],\"text\":[\"2018: -1%\",\"2019: -4%\",\"2020: -3%\",\"2021: -2%\",\"2022: -1%\",\"2023: -4%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(165,0,38,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"FALSE\",\"legendgroup\":\"FALSE\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.90000000000009095,0.90000000000009095,0.90000000000009095],\"base\":[-0.026326576046055594,-0.013238696333714661,-0.015531532469699738],\"x\":[2017,2022,2023],\"y\":[0.026326576046055594,0.013238696333714661,0.015531532469699738],\"text\":[\"2017: -3%\",\"2022: -1%\",\"2023: -2%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(165,0,38,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"FALSE\",\"legendgroup\":\"FALSE\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095],\"base\":[-0.11209493719833552,-0.045503386615988628,-0.14617130531161693,-0.33412631216042454,-0.015522476395145479,-0.10974227533432124],\"x\":[2018,2019,2020,2021,2022,2023],\"y\":[0.11209493719833552,0.045503386615988628,0.14617130531161693,0.33412631216042454,0.015522476395145479,0.10974227533432124],\"text\":[\"2018: -11%\",\"2019: -5%\",\"2020: -15%\",\"2021: -33%\",\"2022: -2%\",\"2023: -11%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(165,0,38,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"FALSE\",\"legendgroup\":\"FALSE\",\"showlegend\":false,\"xaxis\":\"x3\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":0.90000000000009095,\"base\":0,\"x\":[2017],\"y\":[0.012462505381377165],\"text\":\"2017: 1%\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,104,55,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"TRUE\",\"legendgroup\":\"TRUE\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095],\"base\":[0,0,0,0],\"x\":[2018,2019,2020,2021],\"y\":[0.211661645594027,0.058391768258058141,0.1242022527692106,0.39294279296049028],\"text\":[\"2018: 21%\",\"2019: 6%\",\"2020: 12%\",\"2021: 39%\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,104,55,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"TRUE\",\"legendgroup\":\"TRUE\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":0.90000000000009095,\"base\":0,\"x\":[2017],\"y\":[0.0088407282315456914],\"text\":\"2017: 1%\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,104,55,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"TRUE\",\"legendgroup\":\"TRUE\",\"showlegend\":false,\"xaxis\":\"x3\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":null,\"base\":null,\"x\":[null],\"y\":[null],\"text\":\"2016: NA%\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(127,127,127,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"NA\",\"legendgroup\":\"NA\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":null,\"base\":null,\"x\":[null],\"y\":[null],\"text\":\"2016: NA%\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(127,127,127,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"NA\",\"legendgroup\":\"NA\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":null,\"base\":null,\"x\":[null],\"y\":[null],\"text\":\"2016: NA%\",\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(127,127,127,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"NA\",\"legendgroup\":\"NA\",\"showlegend\":false,\"xaxis\":\"x3\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[2016.2049999999999,2023.7950000000001],\"y\":[0,0],\"text\":\"\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[2016.2049999999999,2023.7950000000001],\"y\":[0,0],\"text\":\"\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[2016.2049999999999,2023.7950000000001],\"y\":[0,0],\"text\":\"\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x3\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":56.182648401826484,\"r\":18.99543378995434,\"b\":26.301369863013704,\"l\":48.949771689497723},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Year-over-Year % change in Litre Sales\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,0.32064941653982748],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[2016.2049999999999,2023.7950000000001],\"tickmode\":\"array\",\"ticktext\":[\"2018\",\"2020\",\"2022\"],\"tickvals\":[2018,2020,2022],\"categoryorder\":\"array\",\"categoryarray\":[\"2018\",\"2020\",\"2022\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":\"\",\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-0.37047976741647026,0.429296248216536],\"tickmode\":\"array\",\"ticktext\":[\"-20%\",\"0%\",\"20%\",\"40%\"],\"tickvals\":[-0.20000000000000001,0,0.20000000000000007,0.40000000000000002],\"categoryorder\":\"array\",\"categoryarray\":[\"-20%\",\"0%\",\"20%\",\"40%\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":\"\",\"hoverformat\":\".2f\"},\"annotations\":[{\"text\":\"Litre sales - % chg\",\"x\":0,\"y\":0.5,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-90,\"xanchor\":\"right\",\"yanchor\":\"center\",\"annotationType\":\"axis\",\"xshift\":-33.607305936073061},{\"text\":\"BC\",\"x\":0.16032470826991374,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"Other Prov.\",\"x\":0.49999999999999994,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"},{\"text\":\"Import\",\"x\":0.83967529173008626,\"y\":1,\"showarrow\":false,\"ax\":0,\"ay\":0,\"font\":{\"color\":\"rgba(26,26,26,1)\",\"family\":\"\",\"size\":11.68949771689498},\"xref\":\"paper\",\"yref\":\"paper\",\"textangle\":-0,\"xanchor\":\"center\",\"yanchor\":\"bottom\"}],\"shapes\":[{\"type\":\"rect\",\"fillcolor\":\"transparent\",\"line\":{\"color\":\"rgba(51,51,51,1)\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.32064941653982748,\"y0\":0,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":\"rgba(173,216,230,1)\",\"line\":{\"color\":\"rgba(51,51,51,1)\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.32064941653982748,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":1,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":\"transparent\",\"line\":{\"color\":\"rgba(51,51,51,1)\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.34601725012683915,\"x1\":0.65398274987316074,\"y0\":0,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":\"rgba(173,216,230,1)\",\"line\":{\"color\":\"rgba(51,51,51,1)\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.34601725012683915,\"x1\":0.65398274987316074,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":1,\"ysizemode\":\"pixel\"},{\"type\":\"rect\",\"fillcolor\":\"transparent\",\"line\":{\"color\":\"rgba(51,51,51,1)\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.67935058346017252,\"x1\":1,\"y0\":0,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":\"rgba(173,216,230,1)\",\"line\":{\"color\":\"rgba(51,51,51,1)\",\"width\":0.66417600664176002,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.67935058346017252,\"x1\":1,\"y0\":0,\"y1\":23.37899543378996,\"yanchor\":1,\"ysizemode\":\"pixel\"}],\"xaxis2\":{\"type\":\"linear\",\"autorange\":false,\"range\":[2016.2049999999999,2023.7950000000001],\"tickmode\":\"array\",\"ticktext\":[\"2018\",\"2020\",\"2022\"],\"tickvals\":[2018,2020,2022],\"categoryorder\":\"array\",\"categoryarray\":[\"2018\",\"2020\",\"2022\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"domain\":[0.34601725012683915,0.65398274987316074],\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":\"\",\"hoverformat\":\".2f\"},\"xaxis3\":{\"type\":\"linear\",\"autorange\":false,\"range\":[2016.2049999999999,2023.7950000000001],\"tickmode\":\"array\",\"ticktext\":[\"2018\",\"2020\",\"2022\"],\"tickvals\":[2018,2020,2022],\"categoryorder\":\"array\",\"categoryarray\":[\"2018\",\"2020\",\"2022\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"domain\":[0.67935058346017252,1],\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":\"\",\"hoverformat\":\".2f\"},\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"a765799e096b\":{\"x\":{},\"y\":{},\"text\":{},\"fill\":{},\"type\":\"bar\"},\"a765767c8e2d\":{\"yintercept\":{}}},\"cur_data\":\"a765799e096b\",\"visdat\":{\"a765799e096b\":[\"function (y) \",\"x\"],\"a765767c8e2d\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n#### Cumulative % Change\n\nAll these year-over-year changes add up - especially for Other Province beer and Imports:\n\n-   Other Province beer **almost doubled** over the period, with 90% growth!\n-   Imports **dropped in half**\n-   BC-produced beer saw modest decline.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nch_title <- paste0(\"Total % chg: \", min(trend_yr_cat$year), \" - \", max(trend_yr_cat$year))\n\nplot <- trend_yr_cat %>% ggplot(aes(x=fct_rev(category), y=pc_chg_lt_cum, label=))+geom_col(aes(fill=pc_chg_litres>0), show.legend = FALSE)+\n  geom_text(\n      aes(label=percent(pc_chg_lt_cum, accuracy=1),\n      hjust=0.5,\n      vjust=ifelse(pc_chg_lt_cum>0, -0.5, 1.2)),\n      size=3)+\n  scale_y_continuous(limits=c(-1,1), expand=expansion(add=c(0.2,0.2)),\n                     labels=percent_format(), breaks=c(-1,0,1))+\n  scale_fill_manual(values=c(\"TRUE\"=posneg_col[2], \"FALSE\"=posneg_col[1]))+\n  geom_hline(yintercept=0, linetype='solid')+\n  #coord_flip()+\n  labs(title=ch_title, x=\"\", y=\"\")+\n  theme(axis.ticks.x = element_blank(),\n        axis.line = element_blank(),\n        panel.border = element_rect(fill=NA, size=0.3))\nplot\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=576}\n:::\n:::\n\n\nClearly, b**reweries in other provinces are winning that battle** over imported beer for the roughly 20% of volume not accounted for by BC-produced beer.\n\n#### Where do the dollars go?\n\nNot surprisingly, the shift in volume from Imports to Other Provinces is reflected in dollar sales as well.\n\n\n::: {.cell layout-ncol=\"2\"}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-3e75340f6876a7da1e4a\" style=\"width:100%;height:325px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-3e75340f6876a7da1e4a\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947],\"base\":[1012124931,1045446562,1030231754,996645117,961377476,896125876,918241420,901723927],\"x\":[1,2,3,4,5,6,7,8],\"y\":[68697494,67708808,85034342,87399009,100191238,157851954,160872899,166836167],\"text\":[\"netsales:  68,697,494 <br>cat: Other Prov.\",\"netsales:  67,708,808 <br>cat: Other Prov.\",\"netsales:  85,034,342 <br>cat: Other Prov.\",\"netsales:  87,399,009 <br>cat: Other Prov.\",\"netsales: 100,191,238 <br>cat: Other Prov.\",\"netsales: 157,851,954 <br>cat: Other Prov.\",\"netsales: 160,872,899 <br>cat: Other Prov.\",\"netsales: 166,836,167 <br>cat: Other Prov.\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Other Prov.\",\"legendgroup\":\"Other Prov.\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947],\"base\":[803795853,832007664,838216808,813124324,803576171,793775792,810502255,799159223],\"x\":[1,2,3,4,5,6,7,8],\"y\":[208329078,213438898,192014946,183520793,157801305,102350084,107739165,102564704],\"text\":[\"netsales: 208,329,078 <br>cat: Import\",\"netsales: 213,438,898 <br>cat: Import\",\"netsales: 192,014,946 <br>cat: Import\",\"netsales: 183,520,793 <br>cat: Import\",\"netsales: 157,801,305 <br>cat: Import\",\"netsales: 102,350,084 <br>cat: Import\",\"netsales: 107,739,165 <br>cat: Import\",\"netsales: 102,564,704 <br>cat: Import\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,186,56,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Import\",\"legendgroup\":\"Import\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947],\"base\":[0,0,0,0,0,0,0,0],\"x\":[1,2,3,4,5,6,7,8],\"y\":[803795853,832007664,838216808,813124324,803576171,793775792,810502255,799159223],\"text\":[\"netsales: 803,795,853 <br>cat: BC\",\"netsales: 832,007,664 <br>cat: BC\",\"netsales: 838,216,808 <br>cat: BC\",\"netsales: 813,124,324 <br>cat: BC\",\"netsales: 803,576,171 <br>cat: BC\",\"netsales: 793,775,792 <br>cat: BC\",\"netsales: 810,502,255 <br>cat: BC\",\"netsales: 799,159,223 <br>cat: BC\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(97,156,255,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"BC\",\"legendgroup\":\"BC\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":48.146118721461193,\"r\":7.3059360730593621,\"b\":31.995975037917269,\"l\":40.182648401826491},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Beer $ Sales by Cat.\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,8.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\",\"2023\"],\"tickvals\":[1,2,3,4,5,6,7,8],\"categoryorder\":\"array\",\"categoryarray\":[\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\",\"2023\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-45,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0,1115266096.0999999],\"tickmode\":\"array\",\"ticktext\":[\"$0M\",\"$300M\",\"$600M\",\"$900M\"],\"tickvals\":[0,300000000,600000000,900000000],\"categoryorder\":\"array\",\"categoryarray\":[\"$0M\",\"$300M\",\"$600M\",\"$900M\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"category\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"a7651e9f8eef\":{\"x\":{},\"y\":{},\"fill\":{},\"text\":{},\"type\":\"bar\"}},\"cur_data\":\"a7651e9f8eef\",\"visdat\":{\"a7651e9f8eef\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-38f997b58a8d540f3112\" style=\"width:100%;height:325px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-38f997b58a8d540f3112\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947],\"base\":[0.93643961078990379,0.9391739825142289,0.92375421228621302,0.91937688982966737,0.90561963942731638,0.85023218752143959,0.85092135636836086,0.84386824106871428],\"x\":[1,2,3,4,5,6,7,8],\"y\":[0.063560389210096213,0.0608260174857711,0.076245787713786983,0.080623110170332635,0.094380360572683619,0.14976781247856041,0.14907864363163914,0.15613175893128572],\"text\":[\"share: 6%<br>cat: Other Prov.\",\"share: 6%<br>cat: Other Prov.\",\"share: 8%<br>cat: Other Prov.\",\"share: 8%<br>cat: Other Prov.\",\"share: 9%<br>cat: Other Prov.\",\"share: 15%<br>cat: Other Prov.\",\"share: 15%<br>cat: Other Prov.\",\"share: 16%<br>cat: Other Prov.\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Other Prov.\",\"legendgroup\":\"Other Prov.\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947],\"base\":[0.74368909675426098,0.74743174800477319,0.75158458685899121,0.75008415662961681,0.75697047247381477,0.75312380337260032,0.75108099367181136,0.74788421118035875],\"x\":[1,2,3,4,5,6,7,8],\"y\":[0.19275051403564281,0.19174223450945571,0.17216962542722181,0.16929273320005056,0.14864916695350161,0.097108384148839266,0.099840362696549501,0.095984029888355527],\"text\":[\"share: 19%<br>cat: Import\",\"share: 19%<br>cat: Import\",\"share: 17%<br>cat: Import\",\"share: 17%<br>cat: Import\",\"share: 15%<br>cat: Import\",\"share: 10%<br>cat: Import\",\"share: 10%<br>cat: Import\",\"share: 10%<br>cat: Import\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,186,56,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Import\",\"legendgroup\":\"Import\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947],\"base\":[0,0,0,0,0,0,0,0],\"x\":[1,2,3,4,5,6,7,8],\"y\":[0.74368909675426098,0.74743174800477319,0.75158458685899121,0.75008415662961681,0.75697047247381477,0.75312380337260032,0.75108099367181136,0.74788421118035875],\"text\":[\"share: 74%<br>cat: BC\",\"share: 75%<br>cat: BC\",\"share: 75%<br>cat: BC\",\"share: 75%<br>cat: BC\",\"share: 76%<br>cat: BC\",\"share: 75%<br>cat: BC\",\"share: 75%<br>cat: BC\",\"share: 75%<br>cat: BC\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(97,156,255,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"BC\",\"legendgroup\":\"BC\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":48.146118721461193,\"r\":7.3059360730593621,\"b\":31.995975037917269,\"l\":34.337899543379002},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Beer % $ Sales by Cat.\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,8.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\",\"2023\"],\"tickvals\":[1,2,3,4,5,6,7,8],\"categoryorder\":\"array\",\"categoryarray\":[\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\",\"2023\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-45,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0,1],\"tickmode\":\"array\",\"ticktext\":[\"0%\",\"25%\",\"50%\",\"75%\",\"100%\"],\"tickvals\":[0,0.25,0.5,0.75,1],\"categoryorder\":\"array\",\"categoryarray\":[\"0%\",\"25%\",\"50%\",\"75%\",\"100%\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"category\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"a765d455943\":{\"x\":{},\"y\":{},\"fill\":{},\"text\":{},\"type\":\"bar\"}},\"cur_data\":\"a765d455943\",\"visdat\":{\"a765d455943\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n**BC breweries** have a similarly **stable share of dollar sales**, as with litre sales, although at a slightly lower % share: **\\~75%**. Other provinces are progressively winning the battle for the remaining \\~25%, more than doubling their share of \\$ during the period.\n\n### Regional View\n\nBC LDB provides data for importers by country, allowing us to take a closer look at dynamics within this segment, relative to Other Provinces.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# need a new field for region - need to go back to lmr_data\nlmr_data_reg <- lmr_data_cy %>% mutate(\n  region=ifelse(str_detect(subcategory, 'Domestic - BC'),'Canada - BC',\n                ifelse(str_detect(subcategory, 'Domestic - Other'), 'Canada - Other', subcategory))\n)\n# remove BC to focus on regions outside BC\nlmr_data_reg_xbc <- lmr_data_reg %>% filter(\n  region!='Canada - BC'\n)\n# summarize data by year and region\ntrend_yr_reg <- fn_trend_yr_smry(data=lmr_data_reg_xbc, grp2=region)\n  \n## remove 'beer' from region names for brevity\ntrend_yr_reg <- trend_yr_reg %>% mutate(\n  region=str_replace_all(region, ' Beer','')\n)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell .column-screen-inset-right layout-ncol=\"2\"}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-7ba2b234693a88a2b686\" style=\"width:100%;height:325px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-7ba2b234693a88a2b686\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095],\"base\":[65241409,65134031,63734641,63212736,60423689,59594946,58623849,55463564],\"x\":[2016,2017,2018,2019,2020,2021,2022,2023],\"y\":[47474,62751,153413,100972,60600,104211,233617,394260],\"text\":[\"value:     47,474  <br>cat: Other Country\",\"value:     62,751  <br>cat: Other Country\",\"value:    153,413  <br>cat: Other Country\",\"value:    100,972  <br>cat: Other Country\",\"value:     60,600  <br>cat: Other Country\",\"value:    104,211  <br>cat: Other Country\",\"value:    233,617  <br>cat: Other Country\",\"value:    394,260  <br>cat: Other Country\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Other Country\",\"legendgroup\":\"Other Country\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095],\"base\":[63828909,63735518,62447239,61893317,59426980,58612784,57712184,54372151],\"x\":[2016,2017,2018,2019,2020,2021,2022,2023],\"y\":[1412500,1398513,1287402,1319419,996709,982162,911665,1091413],\"text\":[\"value:  1,412,500  <br>cat: Asia And South Pacific\",\"value:  1,398,513  <br>cat: Asia And South Pacific\",\"value:  1,287,402  <br>cat: Asia And South Pacific\",\"value:  1,319,419  <br>cat: Asia And South Pacific\",\"value:    996,709  <br>cat: Asia And South Pacific\",\"value:    982,162  <br>cat: Asia And South Pacific\",\"value:    911,665  <br>cat: Asia And South Pacific\",\"value:  1,091,413  <br>cat: Asia And South Pacific\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(183,159,0,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Asia And South Pacific\",\"legendgroup\":\"Asia And South Pacific\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095],\"base\":[51688413,51676732,55989497,56417856,57661631,57229152,56211278,53467734],\"x\":[2016,2017,2018,2019,2020,2021,2022,2023],\"y\":[12140496,12058786,6457742,5475461,1765349,1383632,1500906,904417],\"text\":[\"value: 12,140,496  <br>cat: USA\",\"value: 12,058,786  <br>cat: USA\",\"value:  6,457,742  <br>cat: USA\",\"value:  5,475,461  <br>cat: USA\",\"value:  1,765,349  <br>cat: USA\",\"value:  1,383,632  <br>cat: USA\",\"value:  1,500,906  <br>cat: USA\",\"value:    904,417  <br>cat: USA\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,186,56,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"USA\",\"legendgroup\":\"USA\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095],\"base\":[43091200,42884638,46852834,47294341,48087319,55036445,54106926,51779822],\"x\":[2016,2017,2018,2019,2020,2021,2022,2023],\"y\":[8597213,8792094,9136663,9123515,9574312,2192707,2104352,1687912],\"text\":[\"value:  8,597,213  <br>cat: Mexico And Caribbean\",\"value:  8,792,094  <br>cat: Mexico And Caribbean\",\"value:  9,136,663  <br>cat: Mexico And Caribbean\",\"value:  9,123,515  <br>cat: Mexico And Caribbean\",\"value:  9,574,312  <br>cat: Mexico And Caribbean\",\"value:  2,192,707  <br>cat: Mexico And Caribbean\",\"value:  2,104,352  <br>cat: Mexico And Caribbean\",\"value:  1,687,912  <br>cat: Mexico And Caribbean\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,191,196,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Mexico And Caribbean\",\"legendgroup\":\"Mexico And Caribbean\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095],\"base\":[19031947,18530901,22453182,23764263,26715838,37213634,36720974,36150641],\"x\":[2016,2017,2018,2019,2020,2021,2022,2023],\"y\":[24059253,24353737,24399652,23530078,21371481,17822811,17385952,15629181],\"text\":[\"value: 24,059,253  <br>cat: Europe\",\"value: 24,353,737  <br>cat: Europe\",\"value: 24,399,652  <br>cat: Europe\",\"value: 23,530,078  <br>cat: Europe\",\"value: 21,371,481  <br>cat: Europe\",\"value: 17,822,811  <br>cat: Europe\",\"value: 17,385,952  <br>cat: Europe\",\"value: 15,629,181  <br>cat: Europe\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(97,156,255,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Europe\",\"legendgroup\":\"Europe\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095],\"base\":[0,0,0,0,0,0,0,0],\"x\":[2016,2017,2018,2019,2020,2021,2022,2023],\"y\":[19031947,18530901,22453182,23764263,26715838,37213634,36720974,36150641],\"text\":[\"value: 19,031,947  <br>cat: Canada - Other\",\"value: 18,530,901  <br>cat: Canada - Other\",\"value: 22,453,182  <br>cat: Canada - Other\",\"value: 23,764,263  <br>cat: Canada - Other\",\"value: 26,715,838  <br>cat: Canada - Other\",\"value: 37,213,634  <br>cat: Canada - Other\",\"value: 36,720,974  <br>cat: Canada - Other\",\"value: 36,150,641  <br>cat: Canada - Other\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(245,100,227,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Canada - Other\",\"legendgroup\":\"Canada - Other\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":48.146118721461193,\"r\":7.3059360730593621,\"b\":31.995975037917269,\"l\":34.337899543379002},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Beer Litre Sales by Region\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[2015.155,2023.845],\"tickmode\":\"array\",\"ticktext\":[\"2016\",\"2018\",\"2020\",\"2022\"],\"tickvals\":[2016,2018,2020,2022],\"categoryorder\":\"array\",\"categoryarray\":[\"2016\",\"2018\",\"2020\",\"2022\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-45,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0,65288883.100000001],\"tickmode\":\"array\",\"ticktext\":[\"$0M\",\"$20M\",\"$40M\",\"$60M\"],\"tickvals\":[0,20000000,40000000,60000000],\"categoryorder\":\"array\",\"categoryarray\":[\"$0M\",\"$20M\",\"$40M\",\"$60M\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"region\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"a7655aaaabcd\":{\"x\":{},\"y\":{},\"fill\":{},\"text\":{},\"type\":\"bar\"}},\"cur_data\":\"a7655aaaabcd\",\"visdat\":{\"a7655aaaabcd\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-99676049285c14915a30\" style=\"width:100%;height:325px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-99676049285c14915a30\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095],\"base\":[0.99927286242590485,0.99903751384539197,0.99759872166399055,0.99840521108003988,0.99899808692468872,0.99825439746159228,0.99603080091827267,0.99294172289991101],\"x\":[2016,2017,2018,2019,2020,2021,2022,2023],\"y\":[0.00072713757409514912,0.00096248615460803322,0.0024012783360094492,0.0015947889199603438,0.0010019130753111671,0.0017456025384077201,0.0039691990817273259,0.0070582771000889943],\"text\":[\"value:  0.1 % <br>cat: Other Country\",\"value:  0.1 % <br>cat: Other Country\",\"value:  0.2 % <br>cat: Other Country\",\"value:  0.2 % <br>cat: Other Country\",\"value:  0.1 % <br>cat: Other Country\",\"value:  0.2 % <br>cat: Other Country\",\"value:  0.4 % <br>cat: Other Country\",\"value:  0.7 % <br>cat: Other Country\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Other Country\",\"legendgroup\":\"Other Country\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095],\"base\":[0.97763824508990294,0.97758686924149107,0.97744781833549033,0.97756582192279762,0.98251927868408928,0.98180254036082959,0.98054143207592392,0.97340259799594053],\"x\":[2016,2017,2018,2019,2020,2021,2022,2023],\"y\":[0.021634617336001916,0.021450644603900892,0.020150903328500225,0.020839389157242261,0.016478808240599441,0.01645185710076269,0.01548936884234875,0.019539124903970473],\"text\":[\"value:  2.2 % <br>cat: Asia And South Pacific\",\"value:  2.1 % <br>cat: Asia And South Pacific\",\"value:  2.0 % <br>cat: Asia And South Pacific\",\"value:  2.1 % <br>cat: Asia And South Pacific\",\"value:  1.6 % <br>cat: Asia And South Pacific\",\"value:  1.6 % <br>cat: Asia And South Pacific\",\"value:  1.5 % <br>cat: Asia And South Pacific\",\"value:  2.0 % <br>cat: Asia And South Pacific\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(183,159,0,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Asia And South Pacific\",\"legendgroup\":\"Asia And South Pacific\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095],\"base\":[0.79168781306918667,0.79262703487420594,0.87636879658284783,0.89108437623018388,0.95333237694172113,0.95862579768086176,0.95504074198505251,0.95721118674440309],\"x\":[2016,2017,2018,2019,2020,2021,2022,2023],\"y\":[0.18595043202071626,0.18495983436728514,0.1010790217526425,0.086481445692613734,0.029186901742368154,0.023176742679967832,0.025500690090871414,0.016191411251537446],\"text\":[\"value: 18.6 % <br>cat: USA\",\"value: 18.5 % <br>cat: USA\",\"value: 10.1 % <br>cat: USA\",\"value:  8.6 % <br>cat: USA\",\"value:  2.9 % <br>cat: USA\",\"value:  2.3 % <br>cat: USA\",\"value:  2.6 % <br>cat: USA\",\"value:  1.6 % <br>cat: USA\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,186,56,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"USA\",\"legendgroup\":\"USA\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095],\"base\":[0.66000822835336304,0.65777231152298288,0.73335828948554294,0.74698422338492643,0.79503817925345865,0.92189651857228072,0.91928738488333839,0.9269931818325039],\"x\":[2016,2017,2018,2019,2020,2021,2022,2023],\"y\":[0.13167958471582364,0.13485472335122306,0.1430105070973049,0.14410015284525746,0.15829419768826247,0.036729279108581037,0.035753357101714123,0.030218004911899188],\"text\":[\"value: 13.2 % <br>cat: Mexico And Caribbean\",\"value: 13.5 % <br>cat: Mexico And Caribbean\",\"value: 14.3 % <br>cat: Mexico And Caribbean\",\"value: 14.4 % <br>cat: Mexico And Caribbean\",\"value: 15.8 % <br>cat: Mexico And Caribbean\",\"value:  3.7 % <br>cat: Mexico And Caribbean\",\"value:  3.6 % <br>cat: Mexico And Caribbean\",\"value:  3.0 % <br>cat: Mexico And Caribbean\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,191,196,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Mexico And Caribbean\",\"legendgroup\":\"Mexico And Caribbean\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095],\"base\":[0.29150363929491641,0.28423030142806743,0.35144570219653271,0.37534151372085173,0.44169880214678559,0.62335275521562228,0.62389661831516841,0.64719028439059856],\"x\":[2016,2017,2018,2019,2020,2021,2022,2023],\"y\":[0.36850458905844663,0.37354201009491544,0.38191258728901023,0.3716427096640747,0.35333937710667307,0.29854376335665844,0.29539076656816998,0.27980289744190534],\"text\":[\"value: 36.9 % <br>cat: Europe\",\"value: 37.4 % <br>cat: Europe\",\"value: 38.2 % <br>cat: Europe\",\"value: 37.2 % <br>cat: Europe\",\"value: 35.3 % <br>cat: Europe\",\"value: 29.9 % <br>cat: Europe\",\"value: 29.5 % <br>cat: Europe\",\"value: 28.0 % <br>cat: Europe\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(97,156,255,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Europe\",\"legendgroup\":\"Europe\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095,0.90000000000009095],\"base\":[0,0,0,0,0,0,0,0],\"x\":[2016,2017,2018,2019,2020,2021,2022,2023],\"y\":[0.29150363929491641,0.28423030142806743,0.35144570219653271,0.37534151372085173,0.44169880214678559,0.62335275521562228,0.62389661831516841,0.64719028439059856],\"text\":[\"value: 29.2 % <br>cat: Canada - Other\",\"value: 28.4 % <br>cat: Canada - Other\",\"value: 35.1 % <br>cat: Canada - Other\",\"value: 37.5 % <br>cat: Canada - Other\",\"value: 44.2 % <br>cat: Canada - Other\",\"value: 62.3 % <br>cat: Canada - Other\",\"value: 62.4 % <br>cat: Canada - Other\",\"value: 64.7 % <br>cat: Canada - Other\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(245,100,227,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Canada - Other\",\"legendgroup\":\"Canada - Other\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":48.146118721461193,\"r\":7.3059360730593621,\"b\":31.995975037917269,\"l\":34.337899543379002},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Beer Litre Sales % by Region\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[2015.155,2023.845],\"tickmode\":\"array\",\"ticktext\":[\"2016\",\"2018\",\"2020\",\"2022\"],\"tickvals\":[2016,2018,2020,2022],\"categoryorder\":\"array\",\"categoryarray\":[\"2016\",\"2018\",\"2020\",\"2022\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-45,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0,1.0000000000000002],\"tickmode\":\"array\",\"ticktext\":[\"0%\",\"25%\",\"50%\",\"75%\",\"100%\"],\"tickvals\":[0,0.25,0.5,0.75,1],\"categoryorder\":\"array\",\"categoryarray\":[\"0%\",\"25%\",\"50%\",\"75%\",\"100%\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"region\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"a7657a26780f\":{\"x\":{},\"y\":{},\"fill\":{},\"text\":{},\"type\":\"bar\"}},\"cur_data\":\"a7657a26780f\",\"visdat\":{\"a7657a26780f\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nSome interesting dynamics show above:\n\n-   overall downward trend since 2017.\n-   Canadian provinces other than BC have been the gainers while other regions, most notable Europe, Mexico, US have seen declines.\n\nADJUST FOR REGIONAL\n\n\n::: {.cell}\n\n```{.r .cell-code}\nch_title <- paste0(\"Total % chg: \", min(trend_yr_cat$year), \" - \", max(trend_yr_cat$year))\n\nplot <- trend_yr_cat %>% ggplot(aes(x=fct_rev(category), y=pc_chg_lt_cum, label=))+geom_col(aes(fill=pc_chg_litres>0), show.legend = FALSE)+\n  geom_text(\n      aes(label=percent(pc_chg_lt_cum, accuracy=1),\n      hjust=0.5,\n      vjust=ifelse(pc_chg_lt_cum>0, -0.5, 1.2)),\n      size=3)+\n  scale_y_continuous(limits=c(-1,1), expand=expansion(add=c(0.2,0.2)),\n                     labels=percent_format(), breaks=c(-1,0,1))+\n  scale_fill_manual(values=c(\"TRUE\"=posneg_col[2], \"FALSE\"=posneg_col[1]))+\n  geom_hline(yintercept=0, linetype='solid')+\n  #coord_flip()+\n  labs(title=ch_title, x=\"\", y=\"\")+\n  theme(axis.ticks.x = element_blank(),\n        axis.line = element_blank(),\n        panel.border = element_rect(fill=NA, size=0.3))\nplot\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=576}\n:::\n:::\n\n\n### Regional breakout by litres, % change, \\$/litre\n\nWe can do a deeper dive on regional differences by comparing not only litre sales but also % change over time, and \\$/litre (proxy for price):\n\n-   **negative growth** over the period, with the **exception of** '**Canada - other provinces'**.\n\n::: callout-note\n'Canada - other' excluded for simplicity, due to tiny amount of sales.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexcl <- \"Other Country\" # excluding 'other country' as minimal\nplot <- trend_yr_reg %>% filter(year==max(trend_yr_reg$year) & region!=excl) %>% \n  ggplot(aes(x=litres, y=pc_chg_lt_cum, color=region, size=dollar_per_litre))+\n           geom_point()+\n  scale_x_continuous(labels=label_comma())+\n  scale_y_continuous(labels=percent_format())+\n  geom_hline(yintercept = 0, linetype='solid')+\n  theme(axis.line.x = element_blank())+\n  labs(y=\"% chg over period\", x=\"litres sold\")\nggplotly(plot)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-0e7694c0e8a6ea6706cc\" style=\"width:100%;height:433px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-0e7694c0e8a6ea6706cc\">{\"x\":{\"data\":[{\"x\":[1091413],\"y\":[-0.22731823008849561],\"text\":\"litres:  1091413<br />pc_chg_lt_cum: -0.2273182<br />region: Asia And South Pacific<br />dollar_per_litre: 5.641521\",\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"opacity\":1,\"size\":21.669350944991603,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(248,118,109,1)\"}},\"hoveron\":\"points\",\"name\":\"Asia And South Pacific\",\"legendgroup\":\"Asia And South Pacific\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[904417],\"y\":[-0.92550411449416892],\"text\":\"litres:   904417<br />pc_chg_lt_cum: -0.9255041<br />region: USA<br />dollar_per_litre: 5.005272\",\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(163,165,0,1)\",\"opacity\":1,\"size\":14.81006569656267,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(163,165,0,1)\"}},\"hoveron\":\"points\",\"name\":\"USA\",\"legendgroup\":\"USA\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1687912],\"y\":[-0.80366753737519359],\"text\":\"litres:  1687912<br />pc_chg_lt_cum: -0.8036675<br />region: Mexico And Caribbean<br />dollar_per_litre: 5.760432\",\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,191,125,1)\",\"opacity\":1,\"size\":22.677165354330711,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,191,125,1)\"}},\"hoveron\":\"points\",\"name\":\"Mexico And Caribbean\",\"legendgroup\":\"Mexico And Caribbean\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[15629181],\"y\":[-0.35038793598454621],\"text\":\"litres: 15629181<br />pc_chg_lt_cum: -0.3503879<br />region: Europe<br />dollar_per_litre: 5.102942\",\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,176,246,1)\",\"opacity\":1,\"size\":16.113417788088299,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,176,246,1)\"}},\"hoveron\":\"points\",\"name\":\"Europe\",\"legendgroup\":\"Europe\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[36150641],\"y\":[0.89947150441307966],\"text\":\"litres: 36150641<br />pc_chg_lt_cum:  0.8994715<br />region: Canada - Other<br />dollar_per_litre: 4.615027\",\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(231,107,243,1)\",\"opacity\":1,\"size\":3.7795275590551185,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(231,107,243,1)\"}},\"hoveron\":\"points\",\"name\":\"Canada - Other\",\"legendgroup\":\"Canada - Other\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[-857894.20000000019,37912952.200000003],\"y\":[0,0],\"text\":\"yintercept: 0\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":26.958904109589042,\"r\":7.3059360730593621,\"b\":40.913242009132432,\"l\":54.794520547945211},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-857894.20000000019,37912952.200000003],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"10,000,000\",\"20,000,000\",\"30,000,000\"],\"tickvals\":[0,10000000,20000000,30000000],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"10,000,000\",\"20,000,000\",\"30,000,000\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"litres sold\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-1.0167528954395313,0.99072028535844203],\"tickmode\":\"array\",\"ticktext\":[\"-100%\",\"-50%\",\"0%\",\"50%\"],\"tickvals\":[-1,-0.5,0,0.5],\"categoryorder\":\"array\",\"categoryarray\":[\"-100%\",\"-50%\",\"0%\",\"50%\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"% chg over period\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"dollar_per_litre<br />region\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"a7653f638691\":{\"x\":{},\"y\":{},\"colour\":{},\"size\":{},\"type\":\"scatter\"},\"a7651f17ba1a\":{\"yintercept\":{}}},\"cur_data\":\"a7653f638691\",\"visdat\":{\"a7653f638691\":[\"function (y) \",\"x\"],\"a7651f17ba1a\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n-   BC beer is by far the most volume sold, and also by far the cheapest (smallest dot).\n-   Europe, Asia, Mexico, and the US (in that order) have all had decreases in litres sold.\n-   US decline is particularly noteworthy, dropping over 80%! Possibly due to more US brands being produced within Canada, such as Budweiser being brewed in Canada by Labatt (AB InBev) and Coors being brewed by Molson (now Molson Coors).\n\n**Remove BC** to zoom in on others.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot <- trend_yr_reg %>% filter(year==max(trend_yr_reg$year) & region!='Canada - BC' & region!=excl) %>% \n  ggplot(aes(x=litres, y=pc_chg_lt_cum, color=region, size=dollar_per_litre))+\n           geom_point()+\n  scale_x_continuous(labels=label_comma())+\n  scale_y_continuous(labels=percent_format())+\n  geom_hline(yintercept = 0, linetype='solid')+\n  theme(axis.line.x = element_blank())+\n  labs(y=\"% chg over period\", x=\"litres sold\")\nggplotly(plot)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-b38d8207bb6d70dbae7f\" style=\"width:100%;height:433px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-b38d8207bb6d70dbae7f\">{\"x\":{\"data\":[{\"x\":[1091413],\"y\":[-0.22731823008849561],\"text\":\"litres:  1091413<br />pc_chg_lt_cum: -0.2273182<br />region: Asia And South Pacific<br />dollar_per_litre: 5.641521\",\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"opacity\":1,\"size\":21.669350944991603,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(248,118,109,1)\"}},\"hoveron\":\"points\",\"name\":\"Asia And South Pacific\",\"legendgroup\":\"Asia And South Pacific\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[904417],\"y\":[-0.92550411449416892],\"text\":\"litres:   904417<br />pc_chg_lt_cum: -0.9255041<br />region: USA<br />dollar_per_litre: 5.005272\",\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(163,165,0,1)\",\"opacity\":1,\"size\":14.81006569656267,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(163,165,0,1)\"}},\"hoveron\":\"points\",\"name\":\"USA\",\"legendgroup\":\"USA\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1687912],\"y\":[-0.80366753737519359],\"text\":\"litres:  1687912<br />pc_chg_lt_cum: -0.8036675<br />region: Mexico And Caribbean<br />dollar_per_litre: 5.760432\",\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,191,125,1)\",\"opacity\":1,\"size\":22.677165354330711,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,191,125,1)\"}},\"hoveron\":\"points\",\"name\":\"Mexico And Caribbean\",\"legendgroup\":\"Mexico And Caribbean\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[15629181],\"y\":[-0.35038793598454621],\"text\":\"litres: 15629181<br />pc_chg_lt_cum: -0.3503879<br />region: Europe<br />dollar_per_litre: 5.102942\",\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,176,246,1)\",\"opacity\":1,\"size\":16.113417788088299,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,176,246,1)\"}},\"hoveron\":\"points\",\"name\":\"Europe\",\"legendgroup\":\"Europe\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[36150641],\"y\":[0.89947150441307966],\"text\":\"litres: 36150641<br />pc_chg_lt_cum:  0.8994715<br />region: Canada - Other<br />dollar_per_litre: 4.615027\",\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(231,107,243,1)\",\"opacity\":1,\"size\":3.7795275590551185,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(231,107,243,1)\"}},\"hoveron\":\"points\",\"name\":\"Canada - Other\",\"legendgroup\":\"Canada - Other\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[-857894.20000000019,37912952.200000003],\"y\":[0,0],\"text\":\"yintercept: 0\",\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,0,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":26.958904109589042,\"r\":7.3059360730593621,\"b\":40.913242009132432,\"l\":54.794520547945211},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-857894.20000000019,37912952.200000003],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"10,000,000\",\"20,000,000\",\"30,000,000\"],\"tickvals\":[0,10000000,20000000,30000000],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"10,000,000\",\"20,000,000\",\"30,000,000\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"litres sold\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-1.0167528954395313,0.99072028535844203],\"tickmode\":\"array\",\"ticktext\":[\"-100%\",\"-50%\",\"0%\",\"50%\"],\"tickvals\":[-1,-0.5,0,0.5],\"categoryorder\":\"array\",\"categoryarray\":[\"-100%\",\"-50%\",\"0%\",\"50%\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176002,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"% chg over period\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"dollar_per_litre<br />region\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"a765579fc5ba\":{\"x\":{},\"y\":{},\"colour\":{},\"size\":{},\"type\":\"scatter\"},\"a7653a6e6347\":{\"yintercept\":{}}},\"cur_data\":\"a765579fc5ba\",\"visdat\":{\"a765579fc5ba\":[\"function (y) \",\"x\"],\"a7653a6e6347\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nPatterns even more apparent with in zoomed-in view, further emphasizing the growth of 'Canada - Other', with much lower price/litre than others.\n\n#### Changes in Regional Sales Over Time\n\nHere's an animation showing the changes over time, for some extra insight:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_anim <- trend_yr_reg %>% filter(region!=excl) %>%\n  ggplot(aes(x=litres, y=pc_chg_litres, color=region, size=dollar_per_litre))+\n           geom_point()+\n  transition_time(year)+\n  scale_x_continuous(labels=label_comma())+\n  scale_y_continuous(labels=percent_format())+\n  geom_hline(yintercept = 0, linetype='solid')+\n  theme(axis.line.x = element_blank())+\n  labs(y=\"% chg over period\", x=\"litres sold\")\nanimate(plot_anim, duration=10, fps=5)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-18-1.gif)\n:::\n\n```{.r .cell-code}\n#anim_save(\"animated_bubble_chart.gif\")\n```\n:::\n\n\n### Beer: Wrap-up and Next Up\n\nSome interesting dynamics happening with beer sales in BC.\n\n### Footnotes\n\nNotes on 'net \\$ sales':\n\n-   the report says \"**Net dollar value is based on the price paid by the customer** and excludes any applicable taxes.\"\n-   calculating average **net dollar value per litre for beverage categories gives unrealistically low numbers** compared to retail prices in BC liquor stores. (*Beer at average \\$4/litre? Not even the cheapest beer on the [BC Liquor Stores](https://www.bcliquorstores.com/product-catalogue?category=beer&sort=currentPrice:desc&page=1) website.*)\n-   there is likely additional factors related to BC LDB pricing structure, wholesaling, etc.\n-   best to **consider average net dollar value per litre referred to below as relative indicator**.\n\n## \n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}